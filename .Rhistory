#make stack of spartina height
sp_max_stack_fut <- stack(sp_max_2100_dre_RCP8_elnino, sp_max_2100_dre_RCP8_normal,
sp_max_2100_dre_RCP4_elnino, sp_max_2100_dre_RCP4_normal,
sp_max_2100_ND_RCP8_elnino,sp_max_2100_ND_RCP8_normal,
sp_max_2100_ND_RCP4_elnino, sp_max_2100_ND_RCP4_normal,
sp_max_2050_dre_RCP8_elnino, sp_max_2050_dre_RCP8_normal,
sp_max_2050_dre_RCP4_elnino, sp_max_2050_dre_RCP4_normal,
sp_max_2050_ND_RCP8_elnino, sp_max_2050_ND_RCP8_normal,
sp_max_2050_ND_RCP4_elnino, sp_max_2050_ND_RCP4_normal)
names(sp_max_stack_fut) <- c("sp_max_2100_dre_RCP8_elnino", "sp_max_2100_dre_RCP8_normal",
"sp_max_2100_dre_RCP4_elnino", "sp_max_2100_dre_RCP4_normal",
"sp_max_2100_ND_RCP8_elnino", "sp_max_2100_ND_RCP8_normal",
"sp_max_2100_ND_RCP4_elnino", "sp_max_2100_ND_RCP4_normal",
"sp_max_2050_dre_RCP8_elnino", "sp_max_2050_dre_RCP8_normal",
"sp_max_2050_dre_RCP4_elnino", "sp_max_2050_dre_RCP4_normal",
"sp_max_2050_ND_RCP8_elnino", "sp_max_2050_ND_RCP8_normal",
"sp_max_2050_ND_RCP4_elnino", "sp_max_2050_ND_RCP4_normal")
writeRaster(sp_max_stack_fut, "C:/Users/JennyT/Documents/LitReview/UCI/working data/sp_max_stack_fut.grd", format = "raster", overwrite = TRUE)
sp_max_stack_fut <- raster::stack("C:/Users/JennyT/Documents/LitReview/UCI/working data/sp_max_stack_fut.grd")
library(rasterVis)
cols <- colorRampPalette(brewer.pal(9,"YlGn"))
#plot all 8 combinations
print(rasterVis::levelplot(sp_max_stack_fut, names.attr = c("2100_dre_RCP8_elnino", "2100_dre_RCP8_normal",
"2100_dre_RCP4_elnino", "2100_dre_RCP4_normal",
"2100_ND_RCP8_elnino", "2100_ND_RCP8_normal",
"2100_ND_RCP4_elnino", "2100_ND_RCP4_normal",
"2050_dre_RCP8_elnino", "2050_dre_RCP8_normal",
"2050_dre_RCP4_elnino", "2050_dre_RCP4_normal",
"2050_ND_RCP8_elnino", "2050_ND_RCP8_normal",
"2050_ND_RCP4_elnino", "2050_ND_RCP4_normal"),
col.regions=cols,
scales=list(draw=FALSE),
layout=c(4, 4)))#remove axis ticks
#read in data showing the max height of spartina
sp_max_stack <- stack("C:/Users/JennyT/Documents/LitReview/UCI/working data/sp_max_stack.grd")
#read in UNB file to make the bird data spatial
UNB <- st_read("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/UNB_Grid.shp")
#model percent of bird occupancy vs spartina metrics
load("C:/Users/JennyT/Documents/LitReview/UCI/working data/bird_dat_inundation_baseline.RData")
#Logistic reg model with 8 weights to predict percent rail occurrence
summary(mdl_pct_rail_pres <- glm(pct_rail_pres ~ SPSP_MAX_grt60 + SPSP_MAX_95,
family = "binomial",
weights = rep(8, length (pct_rail_pres)), data = bird_dat_inundation))
load("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/bird_dat_inundation_2015_Delft3D_4.RData")
load("C:/Users/JennyT/Documents/LitReview/UCI/working data/mdl_pct_rail_pres.rda")
UNB <- st_read("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/UNB_Grid.shp") %>% st_zm()
load("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/rail_beld_elv_veg.RData")
dat <- dat %>%
dplyr::select(UID, pct_rail_pres)
sp_max_stack_fut <- stack("C:/Users/JennyT/Documents/LitReview/UCI/working data/sp_max_stack_fut.grd")
UNB <- st_read("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/UNB_Grid.shp") %>% st_zm()
UNB <- as_Spatial(UNB)
UNB <- spTransform(UNB, CRSobj = crs(elv_m_2017_baseline))
UNB <- st_as_sf(UNB)
#grt_90 (proportion of acre with spartina greater than 90cm)
bird_dat_inundation_fut<-cbind(UNB, raster::extract(x = sp_max_stack_fut, y = UNB, fun = perc_grt_90, layer = 1, nl = 16))
#function for percent greater than 90
perc_grt_90 <- function(x,...){
d <- x[!is.na(x)]
e <- (sum((d>90)/length(d)))
return(e)
}
#function for percent greater than 60
perc_grt_60 <- function(x,...){
d <- x[!is.na(x)]
e <- (sum((d>60)/length(d)))
return(e)
}
#function for 25th percentile
twentyfifthpercentile <- function(x,...){
d <- quantile(x, probs = 0.25, na.rm = TRUE)
return(d)
}
#function for 5th percentile
fifthpercentile <- function(x,...){
d <- quantile(x, probs = 0.05, na.rm = TRUE)
return(d)
}
#function for 95th percentile
nintyfifthpercentile <- function(x,...){
d <- quantile(x, probs = 0.95, na.rm = TRUE)
return(d)
}
#function for 75th percentile
seventyfifthpercentile <- function(x,...){
d <- quantile(x, probs = 0.75, na.rm = TRUE)
return(d)
}
#function for 50th percentile
medin <- function(x,...){
d <- quantile(x, probs = 0.50, na.rm = TRUE)
return(d)
}
#grt_90 (proportion of acre with spartina greater than 90cm)
bird_dat_inundation_fut<-cbind(UNB, raster::extract(x = sp_max_stack_fut, y = UNB, fun = perc_grt_90, layer = 1, nl = 16))
names(bird_dat_inundation_fut)[2:17] <- names(sp_max_stack_fut)
bird_dat_inundation_fut_tidy <- bird_dat_inundation_fut %>%
gather(sp_max_2100_dre_RCP8_elnino:sp_max_2050_ND_RCP4_normal, key = "key", value = "SPSP_MAX_grt90", na.rm = T) %>%
separate(key, c("spp", "max", "year", "sediment", "RCP", "yrtype"), sep = "_") %>%
dplyr::select(-"spp", -"max")
#MAX_95 (95% percentile value of the max spartina height)
bird_dat_inundation_fut_2<-cbind(UNB, raster::extract(x = sp_max_stack_fut, y = UNB, fun = nintyfifthpercentile, layer = 1, nl = 16))
names(bird_dat_inundation_fut_2)[2:17] <- names(sp_max_stack_fut)
bird_dat_inundation_fut_tidy_2 <- bird_dat_inundation_fut_2 %>%
gather(sp_max_2100_dre_RCP8_elnino:sp_max_2050_ND_RCP4_normal, key = "key", value = "SPSP_MAX_95", na.rm = T) %>%
separate(key, c("spp", "max", "year", "sediment", "RCP", "yrtype"), sep = "_") %>%
dplyr::select(-"spp", -"max")
bird_dat_inundation_fut_3<-cbind(UNB, raster::extract(x = sp_max_stack_fut, y = UNB, fun = perc_grt_60, layer = 1, nl = 16))
names(bird_dat_inundation_fut_3)[2:17] <- names(sp_max_stack_fut)
bird_dat_inundation_fut_tidy_3 <- bird_dat_inundation_fut_3 %>%
gather(sp_max_2100_dre_RCP8_elnino:sp_max_2050_ND_RCP4_normal, key = "key", value = "SPSP_MAX_grt60", na.rm = T) %>%
separate(key, c("spp", "max", "year", "sediment", "RCP", "yrtype"), sep = "_") %>%
dplyr::select(-"spp", -"max")
#join future sp metrics
bird_dat_inundation_fut_4 <- left_join(data.frame(bird_dat_inundation_fut_tidy),
data.frame(bird_dat_inundation_fut_tidy_2),
by = c("UID", "year", "sediment", "RCP", "yrtype"))
bird_dat_inundation_fut_4 <- left_join(bird_dat_inundation_fut_4,
data.frame(bird_dat_inundation_fut_tidy_3),
by = c("UID", "year", "sediment", "RCP", "yrtype"))
bird_dat_inundation_fut_4 <- bird_dat_inundation_fut_4 %>%
select(-c("geometry.x", "geometry.y", "geometry"))
save(bird_dat_inundation_fut_4, file = "C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/future_spartina_UNB.RData")
load("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/future_spartina_UNB.RData")
load("C:/Users/JennyT/Documents/LitReview/UCI/working data/mdl_pct_rail_pres.rda")
bird_dat_inundation_fut_4$predict <- predict(mdl_pct_rail_pres, newdata = bird_dat_inundation_fut_4, type= "response")
railpred <- left_join(UNB, bird_dat_inundation_fut_4, by = "UID")
railpred <- railpred %>%
filter(!is.na(year))
save(railpred, file = "C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/railpred.RData")
load("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/railpred.RData")
#does the year type (el nino vs normal) make a difference
t.test(railpred$predict[railpred$yrtype=="elnino"], railpred$predict[railpred$yrtype =="normal"])
#average the two year types together to reduce the number of scenarios
railpred <- railpred %>%
data.frame() %>%
dplyr::select(-SPSP_MAX_grt90, -SPSP_MAX_95, -SPSP_MAX_grt60, -geometry) %>%
pivot_wider(names_from = yrtype, values_from = predict) %>%
mutate(railprob = (normal+elnino)/2) %>%
select(-elnino, -normal)
railpred <- left_join(UNB, railpred, by = "UID") %>%
filter(!is.na(year))
#plot the probability of rail occurrence
ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_wrap(vars(year, sediment, RCP), nrow = 2)
#plot the probability of rail occurrence
d <- ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_wrap(vars(year, sediment, RCP), nrow = 2)
ggsave(d, filename = "railProbFut.TIFF", dpi = 300, width = 25, height = 15, units = "cm", compression = "lzw")
plot(bird_dat_inundation_2015_Delft3D_4["predict"])
View(bird_dat_inundation_2015_Delft3D_4)
bird_dat_inundation_2015_Delft3D_4$predict <- predict(mdl_pct_rail_pres, newdata = bird_dat_inundation_2015_Delft3D_4, type= "response")
bird_dat_inundation_2015_Delft3D_4 <- left_join(UNB, bird_dat_inundation_2015_Delft3D_4, by = "UID")
plot(bird_dat_inundation_2015_Delft3D_4["predict"])
View(dat)
bird_dat_inundation_2015_Delft3D_4 <- left_join(bird_dat_inundation_2015_Delft3D_4, dat, by = "UID")
plot(bird_dat_inundation_2015_Delft3D_4["predict"])
cor(bird_dat_inundation_2015_Delft3D_4$pct_rail_pres, bird_dat_inundation_2015_Delft3D_4$predict, use = "complete.obs") #0.6584
bwplot(sp_max_stack_fut)
densityplot(sp_max_stack_fut)
View(bird_dat_inundation)
summary(mdl_pct_rail_pres)
table(bird_dat_inundation$year)
unique(bird_dat_inundation_2015_Delft3D_4)
nrow(bird_dat_inundation_2015_Delft3D_4)
save(bird_dat_inundation_2015_Delft3D_4, file = "C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/bird_dat_inundation_2015_Delft3D_4.RData")
library(tidyverse)
library(lubridate)
library(raster)
library(rasterVis)
perc_summ_inund_fut <- raster::stack("C:/Users/JennyT/Documents/LitReview/UCI/working data/perc_summ_inund_fut.grd")
plot(perc_summ_inund_fut)
data.frame(cellStats(perc_summ_inund_fut, quantile))
rasterVis::levelplot(perc_summ_inund_fut, names.attr = c("2100_dre_RCP8_elnino", "2100_dre_RCP8_normal",
"2100_dre_RCP4_elnino", "2100_dre_RCP4_normal",
"2100_ND_RCP8_elnino", "2100_ND_RCP8_normal",
"2100_ND_RCP4_elnino", "2100_ND_RCP4_normal",
"2050_dre_RCP8_elnino", "2050_dre_RCP8_normal",
"2050_dre_RCP4_elnino", "2050_dre_RCP4_normal",
"2050_ND_RCP8_elnino", "2050_ND_RCP8_normal",
"2050_ND_RCP4_elnino", "2050_ND_RCP4_normal"),
col.regions=cols,
scales=list(draw=FALSE),
layout=c(4, 4)))#remove axis ticks
rasterVis::levelplot(perc_summ_inund_fut, names.attr = c("2100_dre_RCP8_elnino", "2100_dre_RCP8_normal",
"2100_dre_RCP4_elnino", "2100_dre_RCP4_normal",
"2100_ND_RCP8_elnino", "2100_ND_RCP8_normal",
"2100_ND_RCP4_elnino", "2100_ND_RCP4_normal",
"2050_dre_RCP8_elnino", "2050_dre_RCP8_normal",
"2050_dre_RCP4_elnino", "2050_dre_RCP4_normal",
"2050_ND_RCP8_elnino", "2050_ND_RCP8_normal",
"2050_ND_RCP4_elnino", "2050_ND_RCP4_normal"),
col.regions=cols,
scales=list(draw=FALSE),
layout=c(4, 4))
class(perc_summ_inund_fut)
?levelplot
levelplot(perc_summ_inund_fut)
levelplot(perc_summ_inund_fut, names.attr = c("2100_dre_RCP8_elnino", "2100_dre_RCP8_normal",
"2100_dre_RCP4_elnino", "2100_dre_RCP4_normal",
"2100_ND_RCP8_elnino", "2100_ND_RCP8_normal",
"2100_ND_RCP4_elnino", "2100_ND_RCP4_normal",
"2050_dre_RCP8_elnino", "2050_dre_RCP8_normal",
"2050_dre_RCP4_elnino", "2050_dre_RCP4_normal",
"2050_ND_RCP8_elnino", "2050_ND_RCP8_normal",
"2050_ND_RCP4_elnino", "2050_ND_RCP4_normal"))
levelplot(perc_summ_inund_fut, names.attr = c("2100_dre_RCP8_elnino", "2100_dre_RCP8_normal",
"2100_dre_RCP4_elnino", "2100_dre_RCP4_normal",
"2100_ND_RCP8_elnino", "2100_ND_RCP8_normal",
"2100_ND_RCP4_elnino", "2100_ND_RCP4_normal",
"2050_dre_RCP8_elnino", "2050_dre_RCP8_normal",
"2050_dre_RCP4_elnino", "2050_dre_RCP4_normal",
"2050_ND_RCP8_elnino", "2050_ND_RCP8_normal",
"2050_ND_RCP4_elnino", "2050_ND_RCP4_normal"),
scales=list(draw=FALSE),
layout=c(4, 4))
?png
png("summ_inund_fut.png", res = 300, width = 25, height = 15, units = "cm")
#plot all 8 combinations
print(rasterVis::levelplot(perc_summ_inund_fut, names.attr = c("2100_dre_RCP8_elnino", "2100_dre_RCP8_normal",
"2100_dre_RCP4_elnino", "2100_dre_RCP4_normal",
"2100_ND_RCP8_elnino", "2100_ND_RCP8_normal",
"2100_ND_RCP4_elnino", "2100_ND_RCP4_normal",
"2050_dre_RCP8_elnino", "2050_dre_RCP8_normal",
"2050_dre_RCP4_elnino", "2050_dre_RCP4_normal",
"2050_ND_RCP8_elnino", "2050_ND_RCP8_normal",
"2050_ND_RCP4_elnino", "2050_ND_RCP4_normal"),
scales=list(draw=FALSE),
layout=c(4, 4)))#remove axis ticks
dev.off()
png("summ_inund_fut.png"), res = 300, width = 25, height = 15, units = "cm")
png("summ_inund_fut.png")
#plot all 8 combinations
print(rasterVis::levelplot(perc_summ_inund_fut, names.attr = c("2100_dre_RCP8_elnino", "2100_dre_RCP8_normal",
"2100_dre_RCP4_elnino", "2100_dre_RCP4_normal",
"2100_ND_RCP8_elnino", "2100_ND_RCP8_normal",
"2100_ND_RCP4_elnino", "2100_ND_RCP4_normal",
"2050_dre_RCP8_elnino", "2050_dre_RCP8_normal",
"2050_dre_RCP4_elnino", "2050_dre_RCP4_normal",
"2050_ND_RCP8_elnino", "2050_ND_RCP8_normal",
"2050_ND_RCP4_elnino", "2050_ND_RCP4_normal"),
scales=list(draw=FALSE),
layout=c(4, 4)))#remove axis ticks
dev.off()
png("summ_inund_fut.png")
#plot all 8 combinations
print(rasterVis::levelplot(perc_summ_inund_fut, names.attr = c("2100_dre_RCP8_elnino", "2100_dre_RCP8_normal",
"2100_dre_RCP4_elnino", "2100_dre_RCP4_normal",
"2100_ND_RCP8_elnino", "2100_ND_RCP8_normal",
"2100_ND_RCP4_elnino", "2100_ND_RCP4_normal",
"2050_dre_RCP8_elnino", "2050_dre_RCP8_normal",
"2050_dre_RCP4_elnino", "2050_dre_RCP4_normal",
"2050_ND_RCP8_elnino", "2050_ND_RCP8_normal",
"2050_ND_RCP4_elnino", "2050_ND_RCP4_normal"),
scales=list(draw=FALSE),
layout=c(4, 4)))#remove axis ticks
dev.off()
Error in dev.off() : cannot shut down device 1 (the null device)
while (!is.null(dev.list()))  dev.off()
dev.off()
png("summ_inund_fut.png", res = 300, width = 25, height = 15, units = "cm")
#plot all 8 combinations
print(rasterVis::levelplot(perc_summ_inund_fut, names.attr = c("2100_dre_RCP8_elnino", "2100_dre_RCP8_normal",
"2100_dre_RCP4_elnino", "2100_dre_RCP4_normal",
"2100_ND_RCP8_elnino", "2100_ND_RCP8_normal",
"2100_ND_RCP4_elnino", "2100_ND_RCP4_normal",
"2050_dre_RCP8_elnino", "2050_dre_RCP8_normal",
"2050_dre_RCP4_elnino", "2050_dre_RCP4_normal",
"2050_ND_RCP8_elnino", "2050_ND_RCP8_normal",
"2050_ND_RCP4_elnino", "2050_ND_RCP4_normal"),
scales=list(draw=FALSE),
layout=c(4, 4)))#remove axis ticks
dev.off()
png("summ_inund_fut.png", res = 300, width = 35, height = 15, units = "cm")
#plot all 8 combinations
print(rasterVis::levelplot(perc_summ_inund_fut, names.attr = c("2100_dre_RCP8_elnino", "2100_dre_RCP8_normal",
"2100_dre_RCP4_elnino", "2100_dre_RCP4_normal",
"2100_ND_RCP8_elnino", "2100_ND_RCP8_normal",
"2100_ND_RCP4_elnino", "2100_ND_RCP4_normal",
"2050_dre_RCP8_elnino", "2050_dre_RCP8_normal",
"2050_dre_RCP4_elnino", "2050_dre_RCP4_normal",
"2050_ND_RCP8_elnino", "2050_ND_RCP8_normal",
"2050_ND_RCP4_elnino", "2050_ND_RCP4_normal"),
scales=list(draw=FALSE),
layout=c(4, 4)))#remove axis ticks
dev.off()
png("summ_inund_fut.png", res = 300, width = 35, height = 10, units = "cm")
#plot all 8 combinations
print(rasterVis::levelplot(perc_summ_inund_fut, names.attr = c("2100_dre_RCP8_elnino", "2100_dre_RCP8_normal",
"2100_dre_RCP4_elnino", "2100_dre_RCP4_normal",
"2100_ND_RCP8_elnino", "2100_ND_RCP8_normal",
"2100_ND_RCP4_elnino", "2100_ND_RCP4_normal",
"2050_dre_RCP8_elnino", "2050_dre_RCP8_normal",
"2050_dre_RCP4_elnino", "2050_dre_RCP4_normal",
"2050_ND_RCP8_elnino", "2050_ND_RCP8_normal",
"2050_ND_RCP4_elnino", "2050_ND_RCP4_normal"),
scales=list(draw=FALSE),
layout=c(4, 4)))#remove axis ticks
dev.off()
png("summ_inund_fut.png", res = 300, width = 25, height = 15, units = "cm")
#plot all 8 combinations
print(rasterVis::levelplot(perc_summ_inund_fut, names.attr = c("2100_dre_RCP8_elnino", "2100_dre_RCP8_normal",
"2100_dre_RCP4_elnino", "2100_dre_RCP4_normal",
"2100_ND_RCP8_elnino", "2100_ND_RCP8_normal",
"2100_ND_RCP4_elnino", "2100_ND_RCP4_normal",
"2050_dre_RCP8_elnino", "2050_dre_RCP8_normal",
"2050_dre_RCP4_elnino", "2050_dre_RCP4_normal",
"2050_ND_RCP8_elnino", "2050_ND_RCP8_normal",
"2050_ND_RCP4_elnino", "2050_ND_RCP4_normal"),
scales=list(draw=FALSE),
layout=c(4, 4)))#remove axis ticks
dev.off()
bwplot(perc_summ_inund_fut)
#2015
load("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/bird_dat_inundation_2015_Delft3D_4.RData")
View(bird_dat_inundation_2015_Delft3D_4)
#future
load("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/railpred.RData")
View(railpred)
#plot the probability of rail occurrence
d <- ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_wrap(vars(year, sediment, RCP), nrow = 2)
ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_wrap(vars(year, sediment, RCP), nrow = 2)
#average the two year types together to reduce the number of scenarios
railpred <- railpred %>%
data.frame() %>%
dplyr::select(-SPSP_MAX_grt90, -SPSP_MAX_95, -SPSP_MAX_grt60, -geometry) %>%
pivot_wider(names_from = yrtype, values_from = predict) %>%
mutate(railprob = (normal+elnino)/2) %>%
select(-elnino, -normal)
#average the two year types together to reduce the number of scenarios
railpred <- railpred %>%
data.frame() %>%
dplyr::select(-SPSP_MAX_grt90, -SPSP_MAX_95, -SPSP_MAX_grt60, -geometry) %>%
pivot_wider(names_from = yrtype, values_from = predict) %>%
mutate(railprob = (normal+elnino)/2) %>%
dplyr::select(-elnino, -normal)
railpred <- left_join(UNB, railpred, by = "UID") %>%
filter(!is.na(year))
UNB <- st_read("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/UNB_Grid.shp")
library(sf)
UNB <- st_read("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/UNB_Grid.shp")
View(UNB)
railpred <- left_join(UNB, railpred, by = "UID") %>%
filter(!is.na(year))
ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_wrap(vars(year, sediment, RCP), nrow = 2)
ggsave(d, filename = "railProbFut.TIFF", dpi = 300, width = 25, height = 15, units = "cm", compression = "lzw")
#plot the probability of rail occurrence
d <- ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_wrap(vars(year, sediment, RCP), nrow = 2)
ggsave(d, filename = "railProbFut.TIFF", dpi = 300, width = 25, height = 15, units = "cm", compression = "lzw")
names(bird_dat_inundation_2015_Delft3D_4)[5] <- "predict2015"
names(bird_dat_inundation_2015_Delft3D_4)[5] <- "railprob2015"
ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_grid(vars(year, RCP), nrow = 2)+
facet_wrap(vars(sediment))
ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_grid(vars(year, RCP))+
facet_wrap(vars(sediment))
?facet_grid
ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_grid(rows=year, cols=RCP)+
facet_wrap(vars(sediment))
ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_grid(rows=vars(year), cols=vars(RCP))+
facet_wrap(vars(sediment))
ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_grid(rows=vars(year), cols=vars(RCP))
ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_grid(rows=vars(year, sediment), cols=vars(RCP))
ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
ggplot(data = bird_dat_inundation_2015_Delft3D_4, aes(fill = railprob2015))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
View(railpred)
chng <- left_join(railpred, bird_dat_inundation_2015_Delft3D_4, by = UID) %>%
mutate(change = railprob - railprob2015)
chng <- left_join(data.frame(railpred), bird_dat_inundation_2015_Delft3D_4, by = UID) %>%
mutate(change = railprob - railprob2015)
chng <- left_join(data.frame(railpred), bird_dat_inundation_2015_Delft3D_4, by = "UID") %>%
mutate(change = railprob - railprob2015)
View(chng)
names(bird_dat_inundation_2015_Delft3D_4)
baseline <- bird_dat_inundation_2015_Delft3D_4 %>%
data.frame() %>%
dplyr::select(UID, railprob2015, pct_rail_pres)
View(baseline)
chng <- left_join(railpred, baseline, by = "UID") %>%
mutate(change = railprob - railprob2015)
View(chng)
View(chng)
ggplot(data = railpred, aes(fill = chaange))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
ggplot(data = chng, aes(fill = chaange))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
summary <- chng %>%
group_by(year, RCP, sediment) %>%
mutate(mean = mean(change))
View(summary)
summary <- chng %>%
group_by(year, RCP, sediment) %>%
summarise(mean = mean(change))
View(summary)
summary <- chng %>%
group_by(year, RCP, sediment) %>%
summarise(mean = mean(change, na.rm = T))
?summarize
summary <- chng %>%
group_by(year, RCP, sediment) %>%
summarise(mean = mean(change, na.rm = TRUE))
summary <- chng %>%
group_by(year, RCP, sediment) %>%
summarise(mean = mean(change, na.rm = TRUE),
firstquartile = quantile(change, probs = 0.25),
thirdQualtile = quantile(change, probs = 0.75))
summary <- chng %>%
group_by(year, RCP, sediment) %>%
summarise(mean = mean(change, na.rm = TRUE),
firstquartile = quantile(change, probs = 0.25, na.rm = TRUE),
thirdQualtile = quantile(change, probs = 0.75, na.rm = TRUE))
View(summary)
plot(sp_max_stack_fut)
sp_max_stack_fut <- raster::stack("C:/Users/JennyT/Documents/LitReview/UCI/working data/sp_max_stack_fut.grd")
plot(sp_max_stack_fut)
