names(summ_2100_dredge_RCP4_normal) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2100_dredge_RCP4_normal <- inundation(elv = elv_m_2100_dre_RCP4 , lev = lev_2100_normal_RCP4[lev_2100_normal_RCP4$season=="W",])
names(wint_2100_dredge_RCP4_normal) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2100_dredge_RCP4_normal <- stack(summ_2100_dredge_RCP4_normal, wint_2100_dredge_RCP4_normal, elv_m_2100_dre_RCP4 )
names(inun_metrics_2100_dredge_RCP4_normal[[15]]) <- "elv_m"
inun_metrics_2100_dredge_RCP4_normal <- writeRaster(inun_metrics_2100_dredge_RCP4_normal, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_dredge_RCP4_normal_inun_metrics_.grd", overwrite=TRUE)
summ_2100_dredge_RCP8_normal_Q33 <- inundation(elv = elv_m_2100_dre_RCP8_Q33  , lev = lev_2100_normal_RCP8[lev_2100_normal_RCP8$season=="S",])
names(summ_2100_dredge_RCP8_normal_Q33) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2100_dredge_RCP8_normal_Q33 <- inundation(elv = elv_m_2100_dre_RCP8_Q33  , lev = lev_2100_normal_RCP8[lev_2100_normal_RCP8$season=="W",])
names(wint_2100_dredge_RCP8_normal_Q33) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2100_dredge_RCP8_normal_Q33 <- stack(summ_2100_dredge_RCP8_normal_Q33, wint_2100_dredge_RCP8_normal_Q33, elv_m_2100_dre_RCP8_Q33  )
names(inun_metrics_2100_dredge_RCP8_normal_Q33[[15]]) <- "elv_m"
inun_metrics_2100_dredge_RCP8_normal_Q33 <- writeRaster(inun_metrics_2100_dredge_RCP8_normal_Q33, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_dredge_RCP8_normal_Q33_inun_metrics_.grd", overwrite=TRUE)
summ_2100_dredge_RCP8_elnino_Q33 <- inundation(elv = elv_m_2100_dre_RCP8_Q33  , lev = lev_2100_elnino_RCP8[lev_2100_elnino_RCP8$season=="S",])
names(summ_2100_dredge_RCP8_elnino_Q33) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2100_dredge_RCP8_elnino_Q33 <- inundation(elv = elv_m_2100_dre_RCP8_Q33  , lev = lev_2100_elnino_RCP8[lev_2100_elnino_RCP8$season=="W",])
names(wint_2100_dredge_RCP8_elnino_Q33) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2100_dredge_RCP8_elnino_Q33 <- stack(summ_2100_dredge_RCP8_elnino_Q33, wint_2100_dredge_RCP8_elnino_Q33, elv_m_2100_dre_RCP8_Q33  )
names(inun_metrics_2100_dredge_RCP8_elnino_Q33[[15]]) <- "elv_m"
inun_metrics_2100_dredge_RCP8_elnino_Q33 <- writeRaster(inun_metrics_2100_dredge_RCP8_elnino_Q33, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_dredge_RCP8_elnino_Q33_inun_metrics_.grd", overwrite=TRUE)
summ_2100_nodredge_RCP8_elnino <- inundation(elv = elv_m_2100_ND_RCP8, lev = lev_2100_elnino_RCP8[lev_2100_elnino_RCP8$season=="S",])
names(summ_2100_nodredge_RCP8_elnino) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2100_nodredge_RCP8_elnino <- inundation(elv = elv_m_2100_ND_RCP8, lev = lev_2100_elnino_RCP8[lev_2100_elnino_RCP8$season=="W",])
names(wint_2100_nodredge_RCP8_elnino) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2100_nodredge_RCP8_elnino <- stack(summ_2100_nodredge_RCP8_elnino, wint_2100_nodredge_RCP8_elnino, elv_m_2100_ND_RCP8)
names(inun_metrics_2100_nodredge_RCP8_elnino[[15]]) <- "elv_m"
inun_metrics_2100_nodredge_RCP8_elnino <- writeRaster(inun_metrics_2100_nodredge_RCP8_elnino, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_ND_RCP8_elnino_inun_metrics_.grd", overwrite=TRUE)
#NoDredge, RCP8.5, 2100, Normal , MSL
summ_2100_nodredge_RCP8_normal <- inundation(elv = elv_m_2100_ND_RCP8, lev = lev_2100_normal_RCP8[lev_2100_normal_RCP8$season=="S",])
names(summ_2100_nodredge_RCP8_normal) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2100_nodredge_RCP8_normal <- inundation(elv = elv_m_2100_ND_RCP8, lev = lev_2100_normal_RCP8[lev_2100_normal_RCP8$season=="W",])
names(wint_2100_nodredge_RCP8_normal) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2100_nodredge_RCP8_normal <- stack(summ_2100_nodredge_RCP8_normal, wint_2100_nodredge_RCP8_normal, elv_m_2100_ND_RCP8)
names(inun_metrics_2100_nodredge_RCP8_normal[[15]]) <- "elv_m"
inun_metrics_2100_nodredge_RCP8_normal <- writeRaster(inun_metrics_2100_nodredge_RCP8_normal, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_ND_RCP8_normal_inun_metrics_.grd", overwrite=TRUE)
#NoDredge, RCP4.5, 2100, El Nino , MSL
summ_2100_nodredge_RCP4_elnino <- inundation(elv = elv_m_2100_ND_RCP4, lev = lev_2100_elnino_RCP4[lev_2100_elnino_RCP4$season=="S",])
names(summ_2100_nodredge_RCP4_elnino) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2100_nodredge_RCP4_elnino <- inundation(elv = elv_m_2100_ND_RCP4, lev = lev_2100_elnino_RCP4[lev_2100_elnino_RCP4$season=="W",])
names(wint_2100_nodredge_RCP4_elnino) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2100_nodredge_RCP4_elnino <- stack(summ_2100_nodredge_RCP4_elnino, wint_2100_nodredge_RCP4_elnino, elv_m_2100_ND_RCP4)
names(inun_metrics_2100_nodredge_RCP4_elnino[[15]]) <- "elv_m"
inun_metrics_2100_nodredge_RCP4_elnino <- writeRaster(inun_metrics_2100_nodredge_RCP4_elnino, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_ND_RCP4_elnino_inun_metrics_.grd", overwrite=TRUE)
#NoDredge, RCP4.5, 2100, Normal  , MSL
summ_2100_nodredge_RCP4_normal <- inundation(elv = elv_m_2100_ND_RCP4, lev = lev_2100_normal_RCP4[lev_2100_normal_RCP4$season=="S",])
names(summ_2100_nodredge_RCP4_normal) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2100_nodredge_RCP4_normal <- inundation(elv = elv_m_2100_ND_RCP4, lev = lev_2100_normal_RCP4[lev_2100_normal_RCP4$season=="W",])
names(wint_2100_nodredge_RCP4_normal) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2100_nodredge_RCP4_normal <- stack(summ_2100_nodredge_RCP4_normal, wint_2100_nodredge_RCP4_normal, elv_m_2100_ND_RCP4)
names(inun_metrics_2100_nodredge_RCP4_normal[[15]]) <- "elv_m"
inun_metrics_2100_nodredge_RCP4_normal <- writeRaster(inun_metrics_2100_nodredge_RCP4_normal, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_ND_RCP4_normal_inun_metrics_.grd", overwrite=TRUE)
#NoDredge, RCP4.5, 2100, Q66, Normal  , MSL
summ_2100_nodredge_RCP4_normal_Q66 <- inundation(elv = elv_m_2100_ND_RCP4_Q66, lev = lev_2100_normal_RCP4[lev_2100_normal_RCP4$season=="S",])
names(summ_2100_nodredge_RCP4_normal_Q66) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2100_nodredge_RCP4_normal_Q66 <- inundation(elv = elv_m_2100_ND_RCP4_Q66, lev = lev_2100_normal_RCP4[lev_2100_normal_RCP4$season=="W",])
names(wint_2100_nodredge_RCP4_normal_Q66) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2100_nodredge_RCP4_normal_Q66 <- stack(summ_2100_nodredge_RCP4_normal_Q66, wint_2100_nodredge_RCP4_normal_Q66, elv_m_2100_ND_RCP4_Q66)
names(inun_metrics_2100_nodredge_RCP4_normal_Q66[[15]]) <- "elv_m"
inun_metrics_2100_nodredge_RCP4_normal_Q66 <- writeRaster(inun_metrics_2100_nodredge_RCP4_normal_Q66, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_ND_RCP4_normal_Q66_inun_metrics_.grd", overwrite=TRUE)
#NoDredge, RCP4.5, 2100, Q66, El Nino  , MSL
summ_2100_nodredge_RCP4_elnino_Q66 <- inundation(elv = elv_m_2100_ND_RCP4_Q66, lev = lev_2100_elnino_RCP4[lev_2100_elnino_RCP4$season=="S",])
names(summ_2100_nodredge_RCP4_elnino_Q66) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2100_nodredge_RCP4_elnino_Q66 <- inundation(elv = elv_m_2100_ND_RCP4_Q66, lev = lev_2100_elnino_RCP4[lev_2100_elnino_RCP4$season=="W",])
names(wint_2100_nodredge_RCP4_elnino_Q66) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2100_nodredge_RCP4_elnino_Q66 <- stack(summ_2100_nodredge_RCP4_elnino_Q66, wint_2100_nodredge_RCP4_elnino_Q66, elv_m_2100_ND_RCP4_Q66)
names(inun_metrics_2100_nodredge_RCP4_elnino_Q66[[15]]) <- "elv_m"
inun_metrics_2100_nodredge_RCP4_elnino_Q66 <- writeRaster(inun_metrics_2100_nodredge_RCP4_elnino_Q66, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_ND_RCP4_elnino_Q66_inun_metrics_.grd", overwrite=TRUE)
summ_2050_dredge_RCP8_elnino <- inundation(elv = elv_m_2050_dre_RCP8, lev = lev_2050_elnino_RCP8[lev_2050_elnino_RCP8$season=="S",])
names(summ_2050_dredge_RCP8_elnino) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_dredge_RCP8_elnino <- inundation(elv = elv_m_2050_dre_RCP8, lev = lev_2050_elnino_RCP8[lev_2050_elnino_RCP8$season=="W",])
names(wint_2050_dredge_RCP8_elnino) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_dredge_RCP8_elnino <- stack(summ_2050_dredge_RCP8_elnino, wint_2050_dredge_RCP8_elnino, elv_m_2050_dre_RCP8)
names(inun_metrics_2050_dredge_RCP8_elnino[[15]]) <- "elv_m"
inun_metrics_2050_dredge_RCP8_elnino <- writeRaster(inun_metrics_2050_dredge_RCP8_elnino, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_dredge_RCP8_elnino_inun_metrics_.grd", overwrite=TRUE)
#Dredge, RCP8.5, 2050, Normal, MSL
summ_2050_dredge_RCP8_normal <- inundation(elv = elv_m_2050_dre_RCP8, lev = lev_2050_normal_RCP8[lev_2050_normal_RCP8$season=="S",])
names(summ_2050_dredge_RCP8_normal) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_dredge_RCP8_normal <- inundation(elv = elv_m_2050_dre_RCP8, lev = lev_2050_normal_RCP8[lev_2050_normal_RCP8$season=="W",])
names(wint_2050_dredge_RCP8_normal) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_dredge_RCP8_normal <- stack(summ_2050_dredge_RCP8_normal, wint_2050_dredge_RCP8_normal, elv_m_2050_dre_RCP8)
names(inun_metrics_2050_dredge_RCP8_normal[[15]]) <- "elv_m"
inun_metrics_2050_dredge_RCP8_normal <- writeRaster(inun_metrics_2050_dredge_RCP8_normal, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_dredge_RCP8_normal_inun_metrics_.grd", overwrite=TRUE)
#Dredge, RCP4.5, 2050, El Nino , MSL
summ_2050_dredge_RCP4_elnino <- inundation(elv = elv_m_2050_dre_RCP4 , lev = lev_2050_elnino_RCP4[lev_2050_elnino_RCP4$season=="S",])
names(summ_2050_dredge_RCP4_elnino) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_dredge_RCP4_elnino <- inundation(elv = elv_m_2050_dre_RCP4 , lev = lev_2050_elnino_RCP4[lev_2050_elnino_RCP4$season=="W",])
names(wint_2050_dredge_RCP4_elnino) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_dredge_RCP4_elnino <- stack(summ_2050_dredge_RCP4_elnino, wint_2050_dredge_RCP4_elnino, elv_m_2050_dre_RCP4 )
names(inun_metrics_2050_dredge_RCP4_elnino[[15]]) <- "elv_m"
inun_metrics_2050_dredge_RCP4_elnino <- writeRaster(inun_metrics_2050_dredge_RCP4_elnino, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_dredge_RCP4_elnino_inun_metrics_.grd", overwrite=TRUE)
#Dredge, RCP4.5, 2050, Normal , MSL
summ_2050_dredge_RCP4_normal <- inundation(elv = elv_m_2050_dre_RCP4 , lev = lev_2050_normal_RCP4[lev_2050_normal_RCP4$season=="S",])
names(summ_2050_dredge_RCP4_normal) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_dredge_RCP4_normal <- inundation(elv = elv_m_2050_dre_RCP4 , lev = lev_2050_normal_RCP4[lev_2050_normal_RCP4$season=="W",])
names(wint_2050_dredge_RCP4_normal) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_dredge_RCP4_normal <- stack(summ_2050_dredge_RCP4_normal, wint_2050_dredge_RCP4_normal, elv_m_2050_dre_RCP4 )
names(inun_metrics_2050_dredge_RCP4_normal[[15]]) <- "elv_m"
inun_metrics_2050_dredge_RCP4_normal <- writeRaster(inun_metrics_2050_dredge_RCP4_normal, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_dredge_RCP4_normal_inun_metrics_.grd", overwrite=TRUE)
#Dredge, RCP8.5, 2050, Normal, Q33, MSL
summ_2050_dredge_RCP8_normal_Q33 <- inundation(elv = elv_m_2050_dre_RCP8_Q33, lev = lev_2050_normal_RCP8[lev_2050_normal_RCP8$season=="S",])
names(summ_2050_dredge_RCP8_normal_Q33) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_dredge_RCP8_normal_Q33 <- inundation(elv = elv_m_2050_dre_RCP8_Q33, lev = lev_2050_normal_RCP8[lev_2050_normal_RCP8$season=="W",])
names(wint_2050_dredge_RCP8_normal_Q33) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_dredge_RCP8_normal_Q33 <- stack(summ_2050_dredge_RCP8_normal_Q33, wint_2050_dredge_RCP8_normal_Q33, elv_m_2050_dre_RCP8_Q33)
names(inun_metrics_2050_dredge_RCP8_normal_Q33[[15]]) <- "elv_m"
inun_metrics_2050_dredge_RCP8_normal_Q33 <- writeRaster(inun_metrics_2050_dredge_RCP8_normal_Q33, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_dredge_RCP8_normal_Q33_inun_metrics_.grd", overwrite=TRUE)
#Dredge, RCP8.5, 2050, El Nino, Q33, MSL
summ_2050_dredge_RCP8_elnino_Q33 <- inundation(elv = elv_m_2050_dre_RCP8_Q33, lev = lev_2050_elnino_RCP8[lev_2050_elnino_RCP8$season=="S",])
names(summ_2050_dredge_RCP8_elnino_Q33) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_dredge_RCP8_elnino_Q33 <- inundation(elv = elv_m_2050_dre_RCP8_Q33, lev = lev_2050_elnino_RCP8[lev_2050_elnino_RCP8$season=="W",])
names(wint_2050_dredge_RCP8_elnino_Q33) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_dredge_RCP8_elnino_Q33 <- stack(summ_2050_dredge_RCP8_elnino_Q33, wint_2050_dredge_RCP8_elnino_Q33, elv_m_2050_dre_RCP8_Q33)
names(inun_metrics_2050_dredge_RCP8_elnino_Q33[[15]]) <- "elv_m"
inun_metrics_2050_dredge_RCP8_elnino_Q33 <- writeRaster(inun_metrics_2050_dredge_RCP8_elnino_Q33, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_dredge_RCP8_elnino_Q33_inun_metrics_.grd", overwrite=TRUE)
#NoDredge, RCP8.5, 2050, El Nino , MSL
summ_2050_nodredge_RCP8_elnino <- inundation(elv = elv_m_2050_ND_RCP8, lev = lev_2050_elnino_RCP8[lev_2050_elnino_RCP8$season=="S",])
names(summ_2050_nodredge_RCP8_elnino) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_nodredge_RCP8_elnino <- inundation(elv = elv_m_2050_ND_RCP8, lev = lev_2050_elnino_RCP8[lev_2050_elnino_RCP8$season=="W",])
names(wint_2050_nodredge_RCP8_elnino) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_nodredge_RCP8_elnino <- stack(summ_2050_nodredge_RCP8_elnino, wint_2050_nodredge_RCP8_elnino, elv_m_2050_ND_RCP8)
names(inun_metrics_2050_nodredge_RCP8_elnino[[15]]) <- "elv_m"
inun_metrics_2050_nodredge_RCP8_elnino <- writeRaster(inun_metrics_2050_nodredge_RCP8_elnino, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_ND_RCP8_elnino_inun_metrics_.grd", overwrite=TRUE)
#NoDredge, RCP8.5, 2050, Normal , MSL
summ_2050_nodredge_RCP8_normal <- inundation(elv = elv_m_2050_ND_RCP8, lev = lev_2050_normal_RCP8[lev_2050_normal_RCP8$season=="S",])
names(summ_2050_nodredge_RCP8_normal) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_nodredge_RCP8_normal <- inundation(elv = elv_m_2050_ND_RCP8, lev = lev_2050_normal_RCP8[lev_2050_normal_RCP8$season=="W",])
names(wint_2050_nodredge_RCP8_normal) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_nodredge_RCP8_normal <- stack(summ_2050_nodredge_RCP8_normal, wint_2050_nodredge_RCP8_normal, elv_m_2050_ND_RCP8)
names(inun_metrics_2050_nodredge_RCP8_normal[[15]]) <- "elv_m"
inun_metrics_2050_nodredge_RCP8_normal <- writeRaster(inun_metrics_2050_nodredge_RCP8_normal, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_ND_RCP8_normal_inun_metrics_.grd", overwrite=TRUE)
#NoDredge, RCP4.5, 2050, El Nino , MSL
summ_2050_nodredge_RCP4_elnino <- inundation(elv = elv_m_2050_ND_RCP4, lev = lev_2050_elnino_RCP4[lev_2050_elnino_RCP4$season=="S",])
names(summ_2050_nodredge_RCP4_elnino) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_nodredge_RCP4_elnino <- inundation(elv = elv_m_2050_ND_RCP4, lev = lev_2050_elnino_RCP4[lev_2050_elnino_RCP4$season=="W",])
names(wint_2050_nodredge_RCP4_elnino) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_nodredge_RCP4_elnino <- stack(summ_2050_nodredge_RCP4_elnino, wint_2050_nodredge_RCP4_elnino, elv_m_2050_ND_RCP4)
names(inun_metrics_2050_nodredge_RCP4_elnino[[15]]) <- "elv_m"
inun_metrics_2050_nodredge_RCP4_elnino <- writeRaster(inun_metrics_2050_nodredge_RCP4_elnino, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_ND_RCP4_elnino_inun_metrics_.grd", overwrite=TRUE)
#NoDredge, RCP4.5, 2050, Normal  , MSL
summ_2050_nodredge_RCP4_normal <- inundation(elv = elv_m_2050_ND_RCP4, lev = lev_2050_normal_RCP4[lev_2050_normal_RCP4$season=="S",])
names(summ_2050_nodredge_RCP4_normal) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_nodredge_RCP4_normal <- inundation(elv = elv_m_2050_ND_RCP4, lev = lev_2050_normal_RCP4[lev_2050_normal_RCP4$season=="W",])
names(wint_2050_nodredge_RCP4_normal) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_nodredge_RCP4_normal <- stack(summ_2050_nodredge_RCP4_normal, wint_2050_nodredge_RCP4_normal, elv_m_2050_ND_RCP4)
names(inun_metrics_2050_nodredge_RCP4_normal[[15]]) <- "elv_m"
inun_metrics_2050_nodredge_RCP4_normal <- writeRaster(inun_metrics_2050_nodredge_RCP4_normal, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_ND_RCP4_normal_inun_metrics_.grd", overwrite=TRUE)
#NoDredge, RCP4.5, 2050, Normal, Q66  , MSL
summ_2050_nodredge_RCP4_normal_Q66 <- inundation(elv = elv_m_2050_ND_RCP4_Q66, lev = lev_2050_normal_RCP4[lev_2050_normal_RCP4$season=="S",])
names(summ_2050_nodredge_RCP4_normal_Q66) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_nodredge_RCP4_normal_Q66 <- inundation(elv = elv_m_2050_ND_RCP4_Q66, lev = lev_2050_normal_RCP4[lev_2050_normal_RCP4$season=="W",])
names(wint_2050_nodredge_RCP4_normal_Q66) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_nodredge_RCP4_normal_Q66 <- stack(summ_2050_nodredge_RCP4_normal_Q66, wint_2050_nodredge_RCP4_normal_Q66, elv_m_2050_ND_RCP4_Q66)
names(inun_metrics_2050_nodredge_RCP4_normal_Q66[[15]]) <- "elv_m"
inun_metrics_2050_nodredge_RCP4_normal_Q66 <- writeRaster(inun_metrics_2050_nodredge_RCP4_normal_Q66, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_ND_RCP4_normal_Q66_inun_metrics_.grd", overwrite=TRUE)
#NoDredge, RCP4.5, 2050, El nino, Q66  , MSL
summ_2050_nodredge_RCP4_elnino_Q66 <- inundation(elv = elv_m_2050_ND_RCP4_Q66, lev = lev_2050_elnino_RCP4[lev_2050_elnino_RCP4$season=="S",])
names(summ_2050_nodredge_RCP4_elnino_Q66) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_nodredge_RCP4_elnino_Q66 <- inundation(elv = elv_m_2050_ND_RCP4_Q66, lev = lev_2050_elnino_RCP4[lev_2050_elnino_RCP4$season=="W",])
names(wint_2050_nodredge_RCP4_elnino_Q66) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_nodredge_RCP4_elnino_Q66 <- stack(summ_2050_nodredge_RCP4_elnino_Q66, wint_2050_nodredge_RCP4_elnino_Q66, elv_m_2050_ND_RCP4_Q66)
names(inun_metrics_2050_nodredge_RCP4_elnino_Q66[[15]]) <- "elv_m"
inun_metrics_2050_nodredge_RCP4_elnino_Q66 <- writeRaster(inun_metrics_2050_nodredge_RCP4_elnino_Q66, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_ND_RCP4_elnino_Q66_inun_metrics_.grd", overwrite=TRUE)
# read in models for the veg prediction
#SPSP_MAX
load(file = "SPSP_MAX_model.rda")
#function to predict SPSP_MAX based on model for each years inundatin metrics
spsp_predict <- function(rasterstack){
sp_max_ct <- raster::predict(rasterstack, mdl_sp_max, type = "response", progress = "text")
#predict prob that its a zero
sp_max_zr <- raster::predict(rasterstack, mdl_sp_max, type = "zero", progress = "text")
#replace values with 0 or 1
values(sp_max_zr)[values(sp_max_zr)>0.5] = 0
values(sp_max_zr)[values(sp_max_zr)<=0.5 & values(sp_max_zr)>0] = 1
#final raster: if zero>0.5 then 0, else count
sp_max <- sp_max_zr * sp_max_ct
plot(sp_max)
return(sp_max)
}
#2015 baseline year for validation with Delft3d
inun_metrics_2015_delft3D  <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/__2015_delft3D_inun_metrics_.grd")
sp_max_2015_delft3D <- spsp_predict(rasterstack = inun_metrics_2015_delft3D)
plot(sp_max_2015_delft3D)
inun_metrics_2100_dre_RCP8_elnino  <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_dredge_RCP8_elnino_inun_metrics_.grd")
sp_max_2100_dre_RCP8_elnino <- spsp_predict(rasterstack = inun_metrics_2100_dre_RCP8_elnino)
inun_metrics_2100_dre_RCP8_normal <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_dredge_RCP8_normal_inun_metrics_.grd")
sp_max_2100_dre_RCP8_normal <- spsp_predict(rasterstack = inun_metrics_2100_dre_RCP8_normal)
inun_metrics_2100_dre_RCP4_elnino <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_dredge_RCP4_elnino_inun_metrics_.grd")
sp_max_2100_dre_RCP4_elnino <- spsp_predict(rasterstack = inun_metrics_2100_dre_RCP4_elnino)
inun_metrics_2100_dre_RCP4_normal <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_dredge_RCP4_normal_inun_metrics_.grd")
sp_max_2100_dre_RCP4_normal <- spsp_predict(rasterstack = inun_metrics_2100_dre_RCP4_normal)
inun_metrics_2100_ND_RCP8_elnino <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_ND_RCP8_elnino_inun_metrics_.grd")
sp_max_2100_ND_RCP8_elnino <- spsp_predict(rasterstack = inun_metrics_2100_ND_RCP8_elnino)
inun_metrics_2100_ND_RCP8_normal <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_ND_RCP8_normal_inun_metrics_.grd")
sp_max_2100_ND_RCP8_normal <- spsp_predict(rasterstack = inun_metrics_2100_ND_RCP8_normal)
inun_metrics_2100_ND_RCP4_elnino <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_ND_RCP4_elnino_inun_metrics_.grd")
sp_max_2100_ND_RCP4_elnino <- spsp_predict(rasterstack = inun_metrics_2100_ND_RCP4_elnino)
inun_metrics_2100_ND_RCP4_normal <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_ND_RCP4_normal_inun_metrics_.grd")
sp_max_2100_ND_RCP4_normal <- spsp_predict(rasterstack = inun_metrics_2100_ND_RCP4_normal)
inun_metrics_2100_ND_RCP4_elnino_Q66 <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_ND_RCP4_elnino_Q66_inun_metrics_.grd")
sp_max_2100_ND_RCP4_elnino_Q66 <- spsp_predict(rasterstack = inun_metrics_2100_ND_RCP4_elnino_Q66)
inun_metrics_2100_ND_RCP4_normal_Q66 <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_ND_RCP4_normal_Q66_inun_metrics_.grd")
sp_max_2100_ND_RCP4_normal_Q66 <- spsp_predict(rasterstack = inun_metrics_2100_ND_RCP4_normal_Q66)
inun_metrics_2100_dre_RCP8_elnino_Q33 <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_dredge_RCP8_elnino_Q33_inun_metrics_.grd")
sp_max_2100_dre_RCP8_elnino_Q33 <- spsp_predict(rasterstack = inun_metrics_2100_dre_RCP8_elnino_Q33)
inun_metrics_2100_dre_RCP8_normal_Q33 <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2100_dredge_RCP8_normal_Q33_inun_metrics_.grd")
sp_max_2100_dre_RCP8_normal_Q33 <- spsp_predict(rasterstack = inun_metrics_2100_dre_RCP8_normal_Q33)
inun_metrics_2050_dre_RCP8_elnino  <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_dredge_RCP8_elnino_inun_metrics_.grd")
sp_max_2050_dre_RCP8_elnino <- spsp_predict(rasterstack = inun_metrics_2050_dre_RCP8_elnino)
inun_metrics_2050_dre_RCP8_normal <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_dredge_RCP8_normal_inun_metrics_.grd")
sp_max_2050_dre_RCP8_normal <- spsp_predict(rasterstack = inun_metrics_2050_dre_RCP8_normal)
inun_metrics_2050_dre_RCP4_elnino <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_dredge_RCP4_elnino_inun_metrics_.grd")
sp_max_2050_dre_RCP4_elnino <- spsp_predict(rasterstack = inun_metrics_2050_dre_RCP4_elnino)
inun_metrics_2050_dre_RCP4_normal <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_dredge_RCP4_normal_inun_metrics_.grd")
sp_max_2050_dre_RCP4_normal <- spsp_predict(rasterstack = inun_metrics_2050_dre_RCP4_normal)
inun_metrics_2050_ND_RCP8_elnino <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_ND_RCP8_elnino_inun_metrics_.grd")
sp_max_2050_ND_RCP8_elnino <- spsp_predict(rasterstack = inun_metrics_2050_ND_RCP8_elnino)
inun_metrics_2050_ND_RCP8_normal <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_ND_RCP8_normal_inun_metrics_.grd")
sp_max_2050_ND_RCP8_normal <- spsp_predict(rasterstack = inun_metrics_2050_ND_RCP8_normal)
inun_metrics_2050_ND_RCP4_elnino <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_ND_RCP4_elnino_inun_metrics_.grd")
sp_max_2050_ND_RCP4_elnino <- spsp_predict(rasterstack = inun_metrics_2050_ND_RCP4_elnino)
inun_metrics_2050_ND_RCP4_normal <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_ND_RCP4_normal_inun_metrics_.grd")
sp_max_2050_ND_RCP4_normal <- spsp_predict(rasterstack = inun_metrics_2050_ND_RCP4_normal)
inun_metrics_2050_ND_RCP4_elnino_Q66 <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_ND_RCP4_elnino_Q66_inun_metrics_.grd")
sp_max_2050_ND_RCP4_elnino_Q66 <- spsp_predict(rasterstack = inun_metrics_2050_ND_RCP4_elnino_Q66)
inun_metrics_2050_ND_RCP4_normal_Q66 <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_ND_RCP4_normal_Q66_inun_metrics_.grd")
sp_max_2050_ND_RCP4_normal_Q66 <- spsp_predict(rasterstack = inun_metrics_2050_ND_RCP4_normal_Q66)
inun_metrics_2050_dre_RCP8_elnino_Q33 <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_dredge_RCP8_elnino_Q33_inun_metrics_.grd")
sp_max_2050_dre_RCP8_elnino_Q33 <- spsp_predict(rasterstack = inun_metrics_2050_dre_RCP8_elnino_Q33)
inun_metrics_2050_dre_RCP8_normal_Q33 <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/_2050_dredge_RCP8_normal_Q33_inun_metrics_.grd")
sp_max_2050_dre_RCP8_normal_Q33 <- spsp_predict(rasterstack = inun_metrics_2050_dre_RCP8_normal_Q33)
#make stack of the %summer inundation
perc_summ_inund_fut <- stack(inun_metrics_2050_ND_RCP4_normal[[6]], inun_metrics_2050_ND_RCP4_elnino[[6]],
inun_metrics_2050_ND_RCP8_normal[[6]], inun_metrics_2050_ND_RCP8_elnino[[6]],
inun_metrics_2050_dre_RCP4_normal[[6]], inun_metrics_2050_dre_RCP4_elnino[[6]],
inun_metrics_2050_dre_RCP8_normal[[6]], inun_metrics_2050_dre_RCP8_elnino[[6]],
inun_metrics_2050_ND_RCP4_normal_Q66[[6]], inun_metrics_2050_ND_RCP4_elnino_Q66[[6]],
inun_metrics_2050_dre_RCP8_normal_Q33[[6]], inun_metrics_2050_dre_RCP8_elnino_Q33[[6]],
inun_metrics_2100_ND_RCP4_normal[[6]], inun_metrics_2100_ND_RCP4_elnino[[6]],
inun_metrics_2100_ND_RCP8_normal[[6]], inun_metrics_2100_ND_RCP8_elnino[[6]],
inun_metrics_2100_dre_RCP4_normal[[6]], inun_metrics_2100_dre_RCP4_elnino[[6]],
inun_metrics_2100_dre_RCP8_normal[[6]], inun_metrics_2100_dre_RCP8_elnino[[6]],
inun_metrics_2100_ND_RCP4_normal_Q66[[6]], inun_metrics_2100_ND_RCP4_elnino_Q66[[6]],
inun_metrics_2100_dre_RCP8_normal_Q33[[6]], inun_metrics_2100_dre_RCP8_elnino_Q33[[6]],
)
perc_summ_inund_fut <- stack(inun_metrics_2050_ND_RCP4_normal[[6]], inun_metrics_2050_ND_RCP4_elnino[[6]],
inun_metrics_2050_ND_RCP8_normal[[6]], inun_metrics_2050_ND_RCP8_elnino[[6]],
inun_metrics_2050_dre_RCP4_normal[[6]], inun_metrics_2050_dre_RCP4_elnino[[6]],
inun_metrics_2050_dre_RCP8_normal[[6]], inun_metrics_2050_dre_RCP8_elnino[[6]])
perc_summ_inund_fut <- stack(inun_metrics_2050_ND_RCP4_normal[[6]], inun_metrics_2050_ND_RCP4_elnino[[6]],
inun_metrics_2050_ND_RCP8_normal[[6]], inun_metrics_2050_ND_RCP8_elnino[[6]],
inun_metrics_2050_dre_RCP4_normal[[6]], inun_metrics_2050_dre_RCP4_elnino[[6]],
inun_metrics_2050_dre_RCP8_normal[[6]], inun_metrics_2050_dre_RCP8_elnino[[6]],
inun_metrics_2050_ND_RCP4_normal_Q66[[6]], inun_metrics_2050_ND_RCP4_elnino_Q66[[6]],
inun_metrics_2050_dre_RCP8_normal_Q33[[6]], inun_metrics_2050_dre_RCP8_elnino_Q33[[6]])
perc_summ_inund_fut <- stack(inun_metrics_2050_ND_RCP4_normal[[6]], inun_metrics_2050_ND_RCP4_elnino[[6]],
inun_metrics_2050_ND_RCP8_normal[[6]], inun_metrics_2050_ND_RCP8_elnino[[6]],
inun_metrics_2050_dre_RCP4_normal[[6]], inun_metrics_2050_dre_RCP4_elnino[[6]],
inun_metrics_2050_dre_RCP8_normal[[6]], inun_metrics_2050_dre_RCP8_elnino[[6]],
inun_metrics_2050_ND_RCP4_normal_Q66[[6]], inun_metrics_2050_ND_RCP4_elnino_Q66[[6]],
inun_metrics_2050_dre_RCP8_normal_Q33[[6]], inun_metrics_2050_dre_RCP8_elnino_Q33[[6]],
inun_metrics_2100_ND_RCP4_normal[[6]], inun_metrics_2100_ND_RCP4_elnino[[6]],
inun_metrics_2100_ND_RCP8_normal[[6]], inun_metrics_2100_ND_RCP8_elnino[[6]],
inun_metrics_2100_dre_RCP4_normal[[6]], inun_metrics_2100_dre_RCP4_elnino[[6]],
inun_metrics_2100_dre_RCP8_normal[[6]], inun_metrics_2100_dre_RCP8_elnino[[6]])
#make stack of the %summer inundation
perc_summ_inund_fut <- stack(inun_metrics_2050_ND_RCP4_normal[[6]], inun_metrics_2050_ND_RCP4_elnino[[6]],
inun_metrics_2050_ND_RCP8_normal[[6]], inun_metrics_2050_ND_RCP8_elnino[[6]],
inun_metrics_2050_dre_RCP4_normal[[6]], inun_metrics_2050_dre_RCP4_elnino[[6]],
inun_metrics_2050_dre_RCP8_normal[[6]], inun_metrics_2050_dre_RCP8_elnino[[6]],
inun_metrics_2050_ND_RCP4_normal_Q66[[6]], inun_metrics_2050_ND_RCP4_elnino_Q66[[6]],
inun_metrics_2050_dre_RCP8_normal_Q33[[6]], inun_metrics_2050_dre_RCP8_elnino_Q33[[6]],
inun_metrics_2100_ND_RCP4_normal[[6]], inun_metrics_2100_ND_RCP4_elnino[[6]],
inun_metrics_2100_ND_RCP8_normal[[6]], inun_metrics_2100_ND_RCP8_elnino[[6]],
inun_metrics_2100_dre_RCP4_normal[[6]], inun_metrics_2100_dre_RCP4_elnino[[6]],
inun_metrics_2100_dre_RCP8_normal[[6]], inun_metrics_2100_dre_RCP8_elnino[[6]],
inun_metrics_2100_ND_RCP4_normal_Q66[[6]], inun_metrics_2100_ND_RCP4_elnino_Q66[[6]])
#make stack of the %summer inundation
perc_summ_inund_fut <- stack(inun_metrics_2050_ND_RCP4_normal[[6]], inun_metrics_2050_ND_RCP4_elnino[[6]],
inun_metrics_2050_ND_RCP8_normal[[6]], inun_metrics_2050_ND_RCP8_elnino[[6]],
inun_metrics_2050_dre_RCP4_normal[[6]], inun_metrics_2050_dre_RCP4_elnino[[6]],
inun_metrics_2050_dre_RCP8_normal[[6]], inun_metrics_2050_dre_RCP8_elnino[[6]],
inun_metrics_2050_ND_RCP4_normal_Q66[[6]], inun_metrics_2050_ND_RCP4_elnino_Q66[[6]],
inun_metrics_2050_dre_RCP8_normal_Q33[[6]], inun_metrics_2050_dre_RCP8_elnino_Q33[[6]],
inun_metrics_2100_ND_RCP4_normal[[6]], inun_metrics_2100_ND_RCP4_elnino[[6]],
inun_metrics_2100_ND_RCP8_normal[[6]], inun_metrics_2100_ND_RCP8_elnino[[6]],
inun_metrics_2100_dre_RCP4_normal[[6]], inun_metrics_2100_dre_RCP4_elnino[[6]],
inun_metrics_2100_dre_RCP8_normal[[6]], inun_metrics_2100_dre_RCP8_elnino[[6]],
inun_metrics_2100_ND_RCP4_normal_Q66[[6]], inun_metrics_2100_ND_RCP4_elnino_Q66[[6]],
inun_metrics_2100_dre_RCP8_normal_Q33[[6]])
#make stack of the %summer inundation
perc_summ_inund_fut <- stack(inun_metrics_2050_ND_RCP4_normal[[6]], inun_metrics_2050_ND_RCP4_elnino[[6]],
inun_metrics_2050_ND_RCP8_normal[[6]], inun_metrics_2050_ND_RCP8_elnino[[6]],
inun_metrics_2050_dre_RCP4_normal[[6]], inun_metrics_2050_dre_RCP4_elnino[[6]],
inun_metrics_2050_dre_RCP8_normal[[6]], inun_metrics_2050_dre_RCP8_elnino[[6]],
inun_metrics_2050_ND_RCP4_normal_Q66[[6]], inun_metrics_2050_ND_RCP4_elnino_Q66[[6]],
inun_metrics_2050_dre_RCP8_normal_Q33[[6]], inun_metrics_2050_dre_RCP8_elnino_Q33[[6]],
inun_metrics_2100_ND_RCP4_normal[[6]], inun_metrics_2100_ND_RCP4_elnino[[6]],
inun_metrics_2100_ND_RCP8_normal[[6]], inun_metrics_2100_ND_RCP8_elnino[[6]],
inun_metrics_2100_dre_RCP4_normal[[6]], inun_metrics_2100_dre_RCP4_elnino[[6]],
inun_metrics_2100_dre_RCP8_normal[[6]], inun_metrics_2100_dre_RCP8_elnino[[6]],
inun_metrics_2100_ND_RCP4_normal_Q66[[6]], inun_metrics_2100_ND_RCP4_elnino_Q66[[6]],
inun_metrics_2100_dre_RCP8_normal_Q33[[6]], inun_metrics_2100_dre_RCP8_elnino_Q33[[6]]
)
names(perc_summ_inund_fut) <- c("perc_summ_inun_2050_ND_RCP4_normal_Q50", "perc_summ_inun_2050_ND_RCP4_elnino_Q50",
"perc_summ_inun_2050_ND_RCP8_normal_Q50", "perc_summ_inun_2050_ND_RCP8_elnino_Q50",
"perc_summ_inun_2050_dre_RCP4_normal_Q50", "perc_summ_inun_2050_dre_RCP4_elnino_Q50",
"perc_summ_inun_2050_dre_RCP8_normal_Q50", "perc_summ_inun_2050_dre_RCP8_elnino_Q50",
"perc_summ_inun_2050_ND_RCP4_normal_Q66", "perc_summ_inun_2050_ND_RCP4_elnino_Q66",
"perc_summ_inun_2050_dre_RCP8_normal_Q33", "perc_summ_inuns_2050_dre_RCP8_elnino_Q33",
"perc_summ_inun_2100_ND_RCP4_normal_Q50", "perc_summ_inun_2100_ND_RCP4_elnino_Q50",
"perc_summ_inun_2100_ND_RCP8_normal_Q50", "perc_summ_inun_2100_ND_RCP8_elnino_Q50",
"perc_summ_inun_2100_dre_RCP4_normal_Q50", "perc_summ_inun_2100_dre_RCP4_elnino_Q50",
"perc_summ_inun_2100_dre_RCP8_normal_Q50", "perc_summ_inun_2100_dre_RCP8_elnino_Q50",
"perc_summ_inun_2100_ND_RCP4_normal_Q66", "perc_summ_inun_2100_ND_RCP4_elnino_Q66",
"perc_summ_inun_2100_dre_RCP8_normal_Q33", "perc_summ_inun_2100_dre_RCP8_elnino_Q33")
writeRaster(perc_summ_inund_fut, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/perc_summ_inund_fut.grd", format = "raster", overwrite = TRUE)
perc_summ_inund_fut <- raster::stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/perc_summ_inund_fut.grd")
#make stack of spartina height
sp_max_stack_fut <- stack(sp_max_2100_dre_RCP8_elnino, sp_max_2100_dre_RCP8_normal,
sp_max_2100_dre_RCP4_elnino, sp_max_2100_dre_RCP4_normal,
sp_max_2100_ND_RCP8_elnino,sp_max_2100_ND_RCP8_normal,
sp_max_2100_ND_RCP4_elnino, sp_max_2100_ND_RCP4_normal,
sp_max_2100_dre_RCP8_elnino_Q33, sp_max_2100_dre_RCP8_normal_Q33,
sp_max_2100_ND_RCP4_elnino_Q66, sp_max_2100_ND_RCP4_normal_Q66,
sp_max_2050_dre_RCP8_elnino, sp_max_2050_dre_RCP8_normal,
sp_max_2050_dre_RCP4_elnino, sp_max_2050_dre_RCP4_normal,
sp_max_2050_ND_RCP8_elnino, sp_max_2050_ND_RCP8_normal,
sp_max_2050_ND_RCP4_elnino, sp_max_2050_ND_RCP4_normal,
sp_max_2050_dre_RCP8_elnino_Q33, sp_max_2050_dre_RCP8_normal_Q33,
sp_max_2050_ND_RCP4_elnino_Q66, sp_max_2050_ND_RCP4_normal_Q66)
names(sp_max_stack_fut) <- c("sp_max_2100_dre_RCP8_elnino_Q50", "sp_max_2100_dre_RCP8_normal_Q50",
"sp_max_2100_dre_RCP4_elnino_Q50", "sp_max_2100_dre_RCP4_normal_Q50",
"sp_max_2100_ND_RCP8_elnino_Q50", "sp_max_2100_ND_RCP8_normal_Q50",
"sp_max_2100_ND_RCP4_elnino_Q50", "sp_max_2100_ND_RCP4_normal_Q50",
"sp_max_2100_dre_RCP8_elnino_Q33", "sp_max_2100_dre_RCP8_normal_Q33",
"sp_max_2100_ND_RCP4_elnino_Q66", "sp_max_2100_ND_RCP4_normal_Q66",
"sp_max_2050_dre_RCP8_elnino_Q50", "sp_max_2050_dre_RCP8_normal_Q50",
"sp_max_2050_dre_RCP4_elnino_Q50", "sp_max_2050_dre_RCP4_normal_Q50",
"sp_max_2050_ND_RCP8_elnino_Q50", "sp_max_2050_ND_RCP8_normal_Q50",
"sp_max_2050_ND_RCP4_elnino_Q50", "sp_max_2050_ND_RCP4_normal_Q50",
"sp_max_2050_dre_RCP8_elnino_Q33", "sp_max_2050_dre_RCP8_normal_Q33",
"sp_max_2050_ND_RCP4_elnino_Q66", "sp_max_2050_ND_RCP4_normal_Q66")
writeRaster(sp_max_stack_fut, "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/sp_max_stack_fut.grd", format = "raster", overwrite = TRUE)
sp_max_stack_fut <- raster::stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/sp_max_stack_fut.grd")
t <- data.frame(cellStats(sp_max_stack_fut, quantile))
View(t)
#read in data showing the max height of spartina
sp_max_stack <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/sp_max_stack.grd")
#  presence and absence acres  for each year for LFRR and BSS
load("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/FinalData/rail_beld_elv_veg.RData")
bird_dat <- dat %>%
dplyr::select(UID:spar_num_pairs)
rm(dat)
#read in UNB file to make the bird data spatial
UNB <- st_read("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/FinalData/UNB_Grid.shp")
bird_dat <- left_join(UNB, bird_dat, by = "UID")
plot(bird_dat["yrs_rail_pres"], main = "LFRR Occupancy (Years)", key.pos = 1,
key.width = lcm(1.3), key.length = 0.5)
#crop the bird data to be just where veg data is
veg_boundary <- st_read("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/UNB Vegetation/Veg_boundary.shp")
veg_boundary <- as(veg_boundary, "Spatial") #veg boundary convert to spatial object
bird_dat_sp <- as(bird_dat, "Spatial")#convert bird object to spatial for cropping
veg_boundary <- spTransform(veg_boundary, CRSobj = crs(bird_dat_sp))
bird_dat_sp <- raster::intersect(veg_boundary, bird_dat_sp ) #crop to extent
plot(bird_dat_sp)
bird_dat <- st_as_sf(bird_dat_sp)
plot(bird_dat["yrs_rail_pres"])
#function for 50th percentile
medin <- function(x,...){
d <- quantile(x, probs = 0.50, na.rm = TRUE)
return(d)
}
#function for 75th percentile
seventyfifthpercentile <- function(x,...){
d <- quantile(x, probs = 0.75, na.rm = TRUE)
return(d)
}
#function for 95th percentile
nintyfifthpercentile <- function(x,...){
d <- quantile(x, probs = 0.95, na.rm = TRUE)
return(d)
}
#function for 5th percentile
fifthpercentile <- function(x,...){
d <- quantile(x, probs = 0.05, na.rm = TRUE)
return(d)
}
#function for 25th percentile
twentyfifthpercentile <- function(x,...){
d <- quantile(x, probs = 0.25, na.rm = TRUE)
return(d)
}
#function for percent greater than 60
perc_grt_60 <- function(x,...){
d <- x[!is.na(x)]
e <- (sum((d>60)/length(d)))
return(e)
}
#function for percent greater than 90
perc_grt_90 <- function(x,...){
d <- x[!is.na(x)]
e <- (sum((d>90)/length(d)))
return(e)
}
#model percent of bird occupancy vs spartina metrics
load("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/bird_dat_inundation_baseline.RData")
ggplot(data = bird_dat_inundation, aes(x = SPSP_MAX_95, y = pct_rail_pres))+
geom_point(alpha = 1/6)+
geom_smooth(method = "lm")
#Logistic reg model with 8 weights to predict percent rail occurrence
summary(mdl_pct_rail_pres <- glm(pct_rail_pres ~ SPSP_MAX_grt60 + SPSP_MAX_95,
family = "binomial",
weights = rep(8, length (pct_rail_pres)), data = bird_dat_inundation))
bird_dat_inundation$predict <- predict(mdl_pct_rail_pres, newdata = bird_dat_inundation, type= "response")
ggplot(data = bird_dat_inundation, aes(x = pct_rail_pres, y = predict))+
geom_point(alpha = 1/6)
plot(bird_dat_inundation[bird_dat_inundation$year==2011,]["predict"])
sp_max_2015_delft3D <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/sp_max_2015_delft3D.grd")
UNB <- st_read("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/FinalData/UNB_Grid.shp") %>% st_zm()
UNB <- as_Spatial(UNB)
UNB <- spTransform(UNB, CRSobj = crs(elv_m_2017_baseline))
UNB <- st_as_sf(UNB)
load("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/mdl_pct_rail_pres.rda")
UNB <- st_read("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/FinalData/UNB_Grid.shp") %>% st_zm()
load("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/FinalData/rail_beld_elv_veg.RData")
dat <- dat %>%
dplyr::select(UID, pct_rail_pres)
sp_max_stack_fut <- stack("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/sp_max_stack_fut.grd")
UNB <- st_read("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/FinalData/UNB_Grid.shp") %>% st_zm()
UNB <- as_Spatial(UNB)
UNB <- spTransform(UNB, CRSobj = crs(elv_m_2017_baseline))
UNB <- st_as_sf(UNB)
#grt_90 (proportion of acre with spartina greater than 90cm)
bird_dat_inundation_fut<-cbind(UNB, raster::extract(x = sp_max_stack_fut, y = UNB, fun = perc_grt_90, layer = 1, nl = 24))
names(bird_dat_inundation_fut)[2:25] <- names(sp_max_stack_fut)
bird_dat_inundation_fut_tidy <- bird_dat_inundation_fut %>%
gather(sp_max_2100_dre_RCP8_elnino_Q50:sp_max_2050_ND_RCP4_normal_Q66, key = "key", value = "SPSP_MAX_grt90", na.rm = T) %>%
separate(key, c("spp", "max", "year", "sediment", "RCP", "yrtype", "flow"), sep = "_") %>%
dplyr::select(-"spp", -"max")
#MAX_95 (95% percentile value of the max spartina height)
bird_dat_inundation_fut_2<-cbind(UNB, raster::extract(x = sp_max_stack_fut, y = UNB, fun = nintyfifthpercentile, layer = 1, nl = 24))
names(bird_dat_inundation_fut_2)[2:25] <- names(sp_max_stack_fut)
bird_dat_inundation_fut_tidy_2 <- bird_dat_inundation_fut_2 %>%
gather(sp_max_2100_dre_RCP8_elnino_Q50:sp_max_2050_ND_RCP4_normal_Q66, key = "key", value = "SPSP_MAX_95", na.rm = T) %>%
separate(key, c("spp", "max", "year", "sediment", "RCP", "yrtype", "flow"), sep = "_") %>%
dplyr::select(-"spp", -"max")
#MAX_grt60 (proportion of acre with spartina greater than 60cm)
bird_dat_inundation_fut_3<-cbind(UNB, raster::extract(x = sp_max_stack_fut, y = UNB, fun = perc_grt_60, layer = 1, nl = 24))
names(bird_dat_inundation_fut_3)[2:25] <- names(sp_max_stack_fut)
bird_dat_inundation_fut_tidy_3 <- bird_dat_inundation_fut_3 %>%
gather(sp_max_2100_dre_RCP8_elnino_Q50:sp_max_2050_ND_RCP4_normal_Q66, key = "key", value = "SPSP_MAX_grt60", na.rm = T) %>%
separate(key, c("spp", "max", "year", "sediment", "RCP", "yrtype", "flow"), sep = "_") %>%
dplyr::select(-"spp", -"max")
#join future sp metrics
bird_dat_inundation_fut_4 <- left_join(data.frame(bird_dat_inundation_fut_tidy),
data.frame(bird_dat_inundation_fut_tidy_2),
by = c("UID", "year", "sediment", "RCP", "yrtype", "flow"))
bird_dat_inundation_fut_4 <- left_join(bird_dat_inundation_fut_4,
data.frame(bird_dat_inundation_fut_tidy_3),
by = c("UID", "year", "sediment", "RCP", "yrtype", "flow"))
bird_dat_inundation_fut_4 <- bird_dat_inundation_fut_4 %>%
select(-c("geometry.x", "geometry.y", "geometry"))
save(bird_dat_inundation_fut_4, file = "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/FinalData/future_spartina_UNB.RData")
load("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/FinalData/future_spartina_UNB.RData")
load("C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/mdl_pct_rail_pres.rda")
bird_dat_inundation_fut_4$predict <- predict(mdl_pct_rail_pres, newdata = bird_dat_inundation_fut_4, type= "response")
railpred <- left_join(UNB, bird_dat_inundation_fut_4, by = "UID")
railpred <- railpred %>%
filter(!is.na(year))
save(railpred, file = "C:/Users/Jenny/Documents/JennySCCWRP/LitReview/UCI/working data/FinalData/railpred.RData")
