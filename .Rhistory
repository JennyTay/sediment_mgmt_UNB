panel.border = element_rect(linetype = "solid", fill = NA))
df <- railpred
df <- df %>%
filter(yrtype == "normal")
c <- ggplot(data = df, mapping = aes(y = predict, x = sediment, fill = RCP))+
geom_boxplot()+
facet_wrap(vars(year))+
labs(y = "LFRR prob of occurrence")+
theme(axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
strip.background = element_rect(colour = "black", fill = "white"),
strip.text.x = element_text(colour = "black", face = "bold", size = 25),
panel.background = element_rect(fill = NA),
panel.grid.major = element_line(colour = NA),
panel.border = element_rect(linetype = "solid", fill = NA))
margin = theme(plot.margin = unit(c(5,7,5,5), "mm"))
p<-arrangeGrob(
a + margin, b+ margin, c+ margin,
nrow = 3)
library(gridExtra)
margin = theme(plot.margin = unit(c(5,7,5,5), "mm"))
p<-arrangeGrob(
a + margin, b+ margin, c+ margin,
nrow = 3)
ggsave("figx.tiff", plot = p, dpi = 300, width = 10, height = 25, compression = "lzw")
ggsave("figx.tiff", plot = p, dpi = 300, width = 15, height = 20, compression = "lzw")
ggsave("figx.tiff", plot = p, dpi = 300, width = 10, height = 20, compression = "lzw")
df <- as.data.frame(perc_summ_inund_fut, xy = TRUE)
names(df)[3:18] <- gsub(pattern = "perc_summ_inun_", replacement = "", x = names(df)[3:18])
df <- df %>%
pivot_longer(cols = 3:18, names_to = "scenario", values_to = "Inundation") %>%
separate(col = "scenario", into = c("Year", "Dredge", "RCP", "climate"), sep = "_") %>%
filter(climate == "normal")
ggplot(data = df, mapping = aes(y = Inundation, x = Dredge, fill = RCP))+
geom_boxplot()+
facet_wrap(vars(Year))+
theme(axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
strip.background = element_rect(colour = "black", fill = "white"),
strip.text.x = element_text(colour = "black", face = "bold", size = 25),
panel.background = element_rect(fill = NA),
panel.grid.major = element_line(colour = NA),
panel.border = element_rect(linetype = "solid", fill = NA),
legend.position = c(.95, .95),
legend.justification = c("right", "top"))
ggplot(data = df, mapping = aes(y = Inundation, x = Dredge, fill = RCP))+
geom_boxplot()+
facet_wrap(vars(Year))+
theme(axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
strip.background = element_rect(colour = "black", fill = "white"),
strip.text.x = element_text(colour = "black", face = "bold", size = 25),
panel.background = element_rect(fill = NA),
panel.grid.major = element_line(colour = NA),
panel.border = element_rect(linetype = "solid", fill = NA),
legend.position = c(.99, .99),
legend.justification = c("right", "top"))
ggplot(data = df, mapping = aes(y = Inundation, x = Dredge, fill = RCP))+
geom_boxplot()+
facet_wrap(vars(Year))+
theme(axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
strip.background = element_rect(colour = "black", fill = "white"),
strip.text.x = element_text(colour = "black", face = "bold", size = 25),
panel.background = element_rect(fill = NA),
panel.grid.major = element_line(colour = NA),
panel.border = element_rect(linetype = "solid", fill = NA),
legend.position = c(.99, .99),
legend.justification = c("right", "top"),
legend.text = element_text(size = 15))
ggplot(data = df, mapping = aes(y = Inundation, x = Dredge, fill = RCP))+
geom_boxplot()+
facet_wrap(vars(Year))+
theme(axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
strip.background = element_rect(colour = "black", fill = "white"),
strip.text.x = element_text(colour = "black", face = "bold", size = 25),
panel.background = element_rect(fill = NA),
panel.grid.major = element_line(colour = NA),
panel.border = element_rect(linetype = "solid", fill = NA),
legend.position = c(.99, .99),
legend.justification = c("right", "top"),
legend.text = element_text(size = 15),
legend.title = element_text(size = 20))
df <- as.data.frame(perc_summ_inund_fut, xy = TRUE)
names(df)[3:18] <- gsub(pattern = "perc_summ_inun_", replacement = "", x = names(df)[3:18])
df <- df %>%
pivot_longer(cols = 3:18, names_to = "scenario", values_to = "Inundation") %>%
separate(col = "scenario", into = c("Year", "Dredge", "RCP", "climate"), sep = "_") %>%
filter(climate == "normal")
a <-  ggplot(data = df, mapping = aes(y = Inundation, x = Dredge, fill = RCP))+
geom_boxplot()+
facet_wrap(vars(Year))+
theme(axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
strip.background = element_rect(colour = "black", fill = "white"),
strip.text.x = element_text(colour = "black", face = "bold", size = 25),
panel.background = element_rect(fill = NA),
panel.grid.major = element_line(colour = NA),
panel.border = element_rect(linetype = "solid", fill = NA),
legend.position = c(.99, .99),
legend.justification = c("right", "top"),
legend.text = element_text(size = 15),
legend.title = element_text(size = 20))
df <- as.data.frame(sp_max_stack_fut, xy = TRUE)
names(df)[3:18] <- gsub(pattern = "sp_max_", replacement = "", x = names(df)[3:18])
df <- df %>%
pivot_longer(cols = 3:18, names_to = "scenario", values_to = "Height") %>%
separate(col = "scenario", into = c("Year", "Dredge", "RCP", "climate"), sep = "_") %>%
filter(climate == "normal")
b <-  ggplot(data = df, mapping = aes(y = Height, x = Dredge, fill = RCP))+
geom_boxplot()+
facet_wrap(vars(Year))+
labs(y = expression(paste("max ", italic("S. foliosa "), "height (cm)", sep = " ")))+
theme(axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
strip.background = element_rect(colour = "black", fill = "white"),
strip.text.x = element_text(colour = "black", face = "bold", size = 25),
panel.background = element_rect(fill = NA),
panel.grid.major = element_line(colour = NA),
panel.border = element_rect(linetype = "solid", fill = NA),
legend.position = "none")
df <- railpred
df <- df %>%
filter(yrtype == "normal")
c <- ggplot(data = df, mapping = aes(y = predict, x = sediment, fill = RCP))+
geom_boxplot()+
facet_wrap(vars(year))+
labs(y = "LFRR prob of occurrence")+
theme(axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
strip.background = element_rect(colour = "black", fill = "white"),
strip.text.x = element_text(colour = "black", face = "bold", size = 25),
panel.background = element_rect(fill = NA),
panel.grid.major = element_line(colour = NA),
panel.border = element_rect(linetype = "solid", fill = NA),
legend.position = "none")
margin = theme(plot.margin = unit(c(5,7,5,5), "mm"))
p<-arrangeGrob(
a + margin, b+ margin, c+ margin,
nrow = 3)
ggsave("figx.tiff", plot = p, dpi = 300, width = 10, height = 20, compression = "lzw")
df <- as.data.frame(perc_summ_inund_fut, xy = TRUE)
names(df)[3:18] <- gsub(pattern = "perc_summ_inun_", replacement = "", x = names(df)[3:18])
df <- df %>%
pivot_longer(cols = 3:18, names_to = "scenario", values_to = "Inundation") %>%
separate(col = "scenario", into = c("Year", "Dredge", "RCP", "climate"), sep = "_") %>%
filter(climate == "normal")
a <-  ggplot(data = df, mapping = aes(y = Inundation, x = Dredge, fill = RCP))+
geom_boxplot()+
facet_wrap(vars(Year))+
labs(x = NULL)+
theme(axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
strip.background = element_rect(colour = "black", fill = "white"),
strip.text.x = element_text(colour = "black", face = "bold", size = 25),
panel.background = element_rect(fill = NA),
panel.grid.major = element_line(colour = NA),
panel.border = element_rect(linetype = "solid", fill = NA),
legend.position = c(.99, .99),
legend.justification = c("right", "top"),
legend.text = element_text(size = 15),
legend.title = element_text(size = 20))
df <- as.data.frame(sp_max_stack_fut, xy = TRUE)
names(df)[3:18] <- gsub(pattern = "sp_max_", replacement = "", x = names(df)[3:18])
df <- df %>%
pivot_longer(cols = 3:18, names_to = "scenario", values_to = "Height") %>%
separate(col = "scenario", into = c("Year", "Dredge", "RCP", "climate"), sep = "_") %>%
filter(climate == "normal")
b <-  ggplot(data = df, mapping = aes(y = Height, x = Dredge, fill = RCP))+
geom_boxplot()+
facet_wrap(vars(Year))+
labs(y = expression(paste("max ", italic("S. foliosa "), "height (cm)", sep = " ")))+
labs(x = NULL)+
theme(axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
strip.background = element_rect(colour = "black", fill = "white"),
strip.text.x = element_text(colour = "black", face = "bold", size = 25),
panel.background = element_rect(fill = NA),
panel.grid.major = element_line(colour = NA),
panel.border = element_rect(linetype = "solid", fill = NA),
legend.position = "none")
df <- railpred
df <- df %>%
filter(yrtype == "normal")
c <- ggplot(data = df, mapping = aes(y = predict, x = sediment, fill = RCP))+
geom_boxplot()+
facet_wrap(vars(year))+
labs(y = "LFRR prob of occurrence")+
theme(axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
strip.background = element_rect(colour = "black", fill = "white"),
strip.text.x = element_text(colour = "black", face = "bold", size = 25),
panel.background = element_rect(fill = NA),
panel.grid.major = element_line(colour = NA),
panel.border = element_rect(linetype = "solid", fill = NA),
legend.position = "none")
margin = theme(plot.margin = unit(c(5,7,5,5), "mm"))
p<-arrangeGrob(
a + margin, b+ margin, c+ margin,
nrow = 3)
ggsave("figx.tiff", plot = p, dpi = 300, width = 10, height = 20, compression = "lzw")
#UNB shapefile
UNB <- st_read("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/UNB_Grid.shp")
#2015
load("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/bird_dat_inundation_2015_Delft3D_4.RData")
names(bird_dat_inundation_2015_Delft3D_4)[5] <- "railprob2015"
ggplot(data = bird_dat_inundation_2015_Delft3D_4, aes(fill = railprob2015))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
#future
load("C:/Users/JennyT/Documents/LitReview/UCI/working data/FinalData/railpred.RData")
#average the two year types together to reduce the number of scenarios
railpred <- railpred %>%
data.frame() %>%
dplyr::select(-SPSP_MAX_grt90, -SPSP_MAX_95, -SPSP_MAX_grt60, -geometry) %>%
pivot_wider(names_from = yrtype, values_from = predict) %>%
mutate(railprob = (normal+elnino)/2) %>%
dplyr::select(-elnino, -normal)
railpred <- left_join(UNB, railpred, by = "UID") %>%
filter(!is.na(year))
ggplot(data = railpred, aes(fill = railprob))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
baseline <- bird_dat_inundation_2015_Delft3D_4 %>%
data.frame() %>%
dplyr::select(UID, railprob2015, pct_rail_pres)
chng <- left_join(railpred, baseline, by = "UID") %>%
mutate(change = railprob - railprob2015)
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
scale_fill_brewer(palette = "RdBu")+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
class(chng$change)
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
scale_fill_brewer(palette = "YlGnBu")+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
scale_fill_brewer(palette = "YlGnBu",type = "seq")+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
scale_color_gradientn(palette = "YlGnBu")+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
scale_fill_gradientn(palette = "YlGnBu")+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
scale_fill_brewer(palette = "OrRd")+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
myPalette <- colorRampPalette(brewer.pal(9, "Greys"))
library(RColorBrewer)
myPalette <- colorRampPalette(brewer.pal(9, "Greys"))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
scale_color_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
myPalette <- colorRampPalette(brewer.pal(9, "Greys"))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
scale_color_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
ggplot(data = chng, aes(fill = chng$change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
scale_color_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
myPalette <- colorRampPalette(brewer.pal(9, "RdYiGn"))
myPalette <- colorRampPalette(brewer.pal(9, "RdYlGn"))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
scale_color_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())+
scale_fill_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
panel.grid.major=element_line(colour="transparent"),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())+
scale_fill_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
panel.grid.major=element_line(colour="transparent"),
panel.background = element_blank(),
axis.text = element_blank())+
scale_fill_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
myPalette <- colorRampPalette(brewer.pal(9, "RdBu"))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Rail Probablity")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
panel.grid.major=element_line(colour="transparent"),
panel.background = element_blank(),
axis.text = element_blank())+
scale_fill_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Change in Rail Probablity from 2015")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
panel.grid.major=element_line(colour="transparent"),
panel.background = element_blank(),
axis.text = element_blank())+
scale_fill_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment), labeller = as_labeller(c("RCP4" = "RCP 4.5", "RCP8" = "RCP 8.5",
"dre" = "Dredge", "ND" = "No Dredge",
"2050" = "2050", "2100" = "2100")))
strip.background = element_rect(fill = "grey99", colour'"black"))+
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Change in Rail Probablity from 2015")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
panel.grid.major=element_line(colour="transparent"),
panel.background = element_blank(),
axis.text = element_blank(),
strip.text = element_text(size = 20),
strip.background = element_rect(fill = "grey99", colour="black"))+
scale_fill_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment), labeller = as_labeller(c("RCP4" = "RCP 4.5", "RCP8" = "RCP 8.5",
"dre" = "Dredge", "ND" = "No Dredge",
"2050" = "2050", "2100" = "2100")))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Change in Rail Probablity from 2015")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
panel.grid.major=element_line(colour="transparent"),
panel.background = element_blank(),
axis.text = element_blank(),
strip.text = element_text(size = 20),
strip.background = element_rect(fill = "grey99", colour="black"))+
scale_fill_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment), labeller = as_labeller(c("RCP4" = "RCP 4.5", "RCP8" = "RCP 8.5",
"dre" = "Dredge", "ND" = "No Dredge",
"2050" = "2050", "2100" = "2100")))
)
)
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Change in Rail Probablity from 2015")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
panel.grid.major=element_line(colour="transparent"),
panel.background = element_blank(),
axis.text = element_blank(),
strip.text = element_text(size = 20),
strip.background = element_rect(fill = "grey99", colour="black"))+
scale_fill_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment), labeller = as_labeller(c("RCP4" = "RCP 4.5", "RCP8" = "RCP 8.5",
"dre" = "Dredge", "ND" = "No Dredge",
"2050" = "2050", "2100" = "2100")))
ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Change in Rail Probablity from 2015")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
title = element_text(size = 30),
panel.grid.major=element_line(colour="transparent"),
panel.background = element_blank(),
axis.text = element_blank(),
strip.text = element_text(size = 20),
strip.background = element_rect(fill = "grey99", colour="black"),
legend.title = element_text(size = 15),
legend.text=element_text(size=20))+
scale_fill_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment), labeller = as_labeller(c("RCP4" = "RCP 4.5", "RCP8" = "RCP 8.5",
"dre" = "Dredge", "ND" = "No Dredge",
"2050" = "2050", "2100" = "2100")))
fig <- ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Change in Rail Probablity from 2015")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
title = element_text(size = 30),
panel.grid.major=element_line(colour="transparent"),
panel.background = element_blank(),
axis.text = element_blank(),
strip.text = element_text(size = 20),
strip.background = element_rect(fill = "grey99", colour="black"),
legend.title = element_text(size = 15),
legend.text=element_text(size=20))+
scale_fill_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment), labeller = as_labeller(c("RCP4" = "RCP 4.5", "RCP8" = "RCP 8.5",
"dre" = "Dredge", "ND" = "No Dredge",
"2050" = "2050", "2100" = "2100")))
ggsave("fig1.tiff", plot = fig, dpi = 300, width = 20, height = 20, compression = "lzw")
fig <- ggplot(data = chng, aes(fill = change))+
geom_sf(color = NA)+
labs(title = "Change in Rail Probablity from 2015")+
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
title = element_text(size = 30),
panel.grid.major=element_line(colour="transparent"),
panel.background = element_blank(),
axis.text = element_blank(),
strip.text = element_text(size = 25),
strip.background = element_rect(fill = "grey99", colour="black"),
legend.title = element_text(size = 25),
legend.text=element_text(size=20))+
scale_fill_gradientn(colours = myPalette(100))+
facet_grid(rows=vars(year), cols=vars(RCP, sediment), labeller = as_labeller(c("RCP4" = "RCP 4.5", "RCP8" = "RCP 8.5",
"dre" = "Dredge", "ND" = "No Dredge",
"2050" = "2050", "2100" = "2100")))
ggsave("fig1.tiff", plot = fig, dpi = 300, width = 20, height = 20, compression = "lzw")
