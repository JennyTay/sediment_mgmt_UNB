library(raster)
library(tidyverse)
library(lubridate)
library(readxl)
library(sf)
library(caret)
library(sp)
library(rgeos)
#read in 2012 Thorne vegetation survey
veg<- read_excel("Newport_Vegetation_FINAL_K_Thorne.xlsx")
# Calculate Inundation from raster elevation and LA Water level data ##
# Elevation is NAVD88 Based on report Need to confirm with Karen (unit is meters)
elv_m_2012<- raster("WARMER/Newport_DEM_m_2012.TIF")
#water level data NAVD88, Unit is feet so will need to conver to meters
lev_2012<-read.csv("LAWaterLevel/CO-OPS_9410660_wl_2012.csv") %>%
mutate(lev_m = Verified..ft.*0.3048)%>% #convert to m
dplyr::select(1,2,6) %>%
unite(date, 1,2, sep = " ") #make single date column
lev_2012$date<-ymd_hm(lev_2012$date) #convert to date object
lev_2012$season<-ifelse(month(lev_2012$date)%in% c(1,2,3,10,11,12), "W", "S") #add column for season
inun_metrics_12 <- stack("C:/Users/JennyT/Documents/LitReview/UCI/working data/2012_inun_metrics.grd")
plot(x = inun_metrics_12, y = 6, main = '', axes = F) # not sure why main isnt working
title(main = "Summer Inundation 2012 (%)")
plot(x = inun_metrics_12, y = 13, main = '', axes = F) # not sure why main isnt working
title(main = "Elevation 2012 (m)")
#read in 2012 Thorne vegetation survey
veg<- read_excel("Newport_Vegetation_FINAL_K_Thorne.xlsx")
names(veg)[1] <- "Point_ID"
ID<-veg$Point_ID
#keep just % cover, max, avg height
veg<- veg[,!grepl(pattern = "MIN$", colnames(veg))]
veg<- veg[,!grepl(pattern = "^UNK", colnames(veg))]
veg<-veg %>% dplyr::select(-"QA/QC Notes", -"DODDER")
#make NAs in the veg df 0
veg[is.na(veg)]<-0
# read in Thorne 2012 elevation survey
UNB_elv<- st_read("L:/UCI_NOAA coastal wetland response to SLR_ES/Data/RawData/USGS Newport data delivery 6.28.18/Newport RTK GPS/6 Newport/Newport Elevation Points.shp")
# read in Thorne 2012 elevation survey
UNB_elv<- st_read("Newport RTK GPS/6 Newport/Newport Elevation Points.shp")
UNB_elv$Point_ID<- as.character(UNB_elv$Point_ID)
# join veg to elevation so veg gets spatial information
veg<- left_join(UNB_elv, veg, by = "Point_ID") %>% st_zm()
# filter for only the pts where veg data was take
veg<- veg %>%
filter(Point_ID %in% ID)
veg<-st_transform(veg, crs = crs(elv_m_2012)) # project veg to correct crs
veg<-as_Spatial(veg) #convert to spatial data type
veg<-cbind(veg, raster::extract(x = inun_metrics_12, y = veg, layer = 1, nl = 13))
#convert to sf
veg <- st_as_sf(veg)
library(GGally)
ggplot(data = veg, mapping = aes(x = summ_inu_pct, y = SPSP_MAX))+
geom_point(alpha = 1/3)+
labs(x = "Summer Inundation (%)", y = "Height (cm)", title = "Maximum S. foliosa height")+
geom_smooth(method = "glm",formula = y~x+I(x^2))
ggplot(data = veg, mapping = aes(x= SAPA_MAX))+
geom_histogram(binwidth = 5)
var(veg$SPSP_MAX) #much much larger - probabaly want to do a zero inflated negative bionmial
mean(veg$SPSP_MAX)
veg$summ_inu_pct_sq<-(veg$summ_inu_pct)^2
#SPSP_max model
mdl_sp_max <- zeroinfl(SPSP_MAX ~ summ_inu_pct + summ_inu_pct_sq | summ_inu_pct,
dist = "negbin",
data = veg,
EM = TRUE)
??zeroinfl
library(pscl)
library(boot)
#SPSP_max model
mdl_sp_max <- zeroinfl(SPSP_MAX ~ summ_inu_pct + summ_inu_pct_sq | summ_inu_pct,
dist = "negbin",
data = veg,
EM = TRUE)
summary(mdl_sp_max)
save(mdl_sp_max, file = "SPSP_MAX_model.rda")
#test prediction on the data
prd <- data.frame("summ_inu_pct" = veg$summ_inu_pct, "summ_inu_pct_sq" = veg$summ_inu_pct_sq)
predict_ct <- predict(mdl_sp_max, newdata = prd, type = "response")
predict_zr <- predict(mdl_sp_max, newdata = prd, type = "zero")
compare <- data.frame("SPSP_MAX"=veg$SPSP_MAX, "ct" = predict_ct, "zr" = predict_zr)
compare$zr_binary <- as.factor(ifelse(compare$zr <=.5, 1, 0))
ggplot(data = compare, mapping = aes(x = SPSP_MAX, y = ct, col = zr_binary))+
geom_point(alpha = 1/2)+
xlim(c(0,150))+
ylim(c(0,150))
#how many false postives
false_pos <- compare %>%
filter(SPSP_MAX == 0 & zr_binary == 1) # 14 false positives out of 240 (5.8%)
#how many true negatives
true_neg <- compare %>%
filter(SPSP_MAX!=0 & zr_binary ==0) # 15 true negatives (6.2%)
load("SPSP_MAX_model.rda")
#2012 inundation raster stack - adding in summ12_inu_pct_cubed
summ_inu_pct_sq <- raster(inun_metrics_12, layer = 6)
summ_inu_pct_sq <- summ_inu_pct_sq^2
inun_metrics_12 <- addLayer(inun_metrics_12, summ_inu_pct_sq)
names(inun_metrics_12) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht", "summ_max_ht_above_wl",
"summ_max_depth_below_wl", "summ_inu_pct",
"wint_avg_ht_above_m", "wint_avg_ht_below_m","wint_avg_height", "wint_max_ht_above_wl",
"wint_max_depth_below_wl", "wint_inu_pct",
"elv_m", "summ_inu_pct_sq")
#2012
sp_max_ct <- raster::predict(inun_metrics_12, mdl_sp_max, type = "response", progress = "text")
#predict prob that its a zero
sp_max_zr <- raster::predict(inun_metrics_12, mdl_sp_max, type = "zero", progress = "text")
#replace values with 0 or 1
values(sp_max_zr)[values(sp_max_zr)>0.5] = 0
values(sp_max_zr)[values(sp_max_zr)<=0.5 & values(sp_max_zr)>0] = 1
#final raster: if zero>0.5 then 0, else count
sp_max_2012 <- sp_max_zr * sp_max_ct
plot(sp_max_2012, main = "2012")
#water level
lev_2011<-read.csv("LAWaterLevel/CO-OPS_9410660_wl_2011.csv")
lev_2013<-read.csv("LAWaterLevel/CO-OPS_9410660_wl_2013.csv")
lev_2014<-read.csv("LAWaterLevel/CO-OPS_9410660_wl_2014.csv")
lev_2015<-read.csv("LAWaterLevel/CO-OPS_9410660_wl_2015.csv")
lev_2016<-read.csv("LAWaterLevel/CO-OPS_9410660_wl_2016.csv")
lev_2017<-read.csv("LAWaterLevel/CO-OPS_9410660_wl_2017.csv")
lev_2018<-read.csv("LAWaterLevel/CO-OPS_9410660_wl_2018.csv")
#water level in MSL to be used with Matts Delft3D raster. 2011 is a normal year and 2015 is an el nino year
lev_2011_MSL <- read.csv("LAWaterLevel/CO-OPS_9410660_wl_2011_MSL.csv")
lev_2015_MSL <- read.csv("LAWaterLevel/CO-OPS_9410660_wl_2015_MSL.csv")
tidy_water_level <- function(timeseries){
timeseries <-  timeseries %>%
mutate(lev_m = Verified..ft.*0.3048)%>% #convert to m
dplyr::select(1,2,6) %>%
unite(date, 1,2, sep = " ") #make single date column
timeseries$date<-ymd_hm(timeseries$date) #convert to date object
timeseries$season<-ifelse(month(timeseries$date)%in% c(1,2,3,10,11,12), "W", "S") #add column for season
return(timeseries)
}
#tid water level function for the MSL csvs which for some reason are getting read in differently
tidy_water_level2 <- function(timeseries){
timeseries <-  timeseries %>%
mutate(lev_m = Verified..ft.*0.3048)%>% #convert to m
dplyr::select(1,2,6) %>%
unite(date, 1,2, sep = " ") #make single date column
timeseries$date<-mdy_hm(timeseries$date) #convert to date object
timeseries$season<-ifelse(month(timeseries$date)%in% c(1,2,3,10,11,12), "W", "S") #add column for season
return(timeseries)
}
#these levels are all NAV*88
lev_2011 <- tidy_water_level(timeseries = lev_2011)
lev_2013 <- tidy_water_level(timeseries = lev_2013)
lev_2014 <- tidy_water_level(timeseries = lev_2014)
lev_2015 <- tidy_water_level(timeseries = lev_2015)
lev_2016 <- tidy_water_level(timeseries = lev_2016)
lev_2017 <- tidy_water_level(timeseries = lev_2017)
lev_2018 <- tidy_water_level(timeseries = lev_2018)
#RCP 8.5 , 2100, normal year, MSL
lev_2011_MSL <- tidy_water_level2(timeseries = lev_2011_MSL)
lev_2100_normal_RCP8 <- lev_2011_MSL %>%
mutate(lev_m_2100 = lev_m+1.09728) %>%
dplyr::select(1,4,3)
#RCP 4.5 , 2100, normal year, MSL
lev_2100_normal_RCP4 <- lev_2011_MSL %>%
mutate(lev_m_2100 = lev_m+0.3962) %>%
dplyr::select(1,4,3)
#RCP 8.5 , 2100, el nino year, MSL
lev_2015_MSL <- tidy_water_level2(timeseries = lev_2015_MSL)
lev_2100_elnino_RCP8 <- lev_2015_MSL %>%
mutate(lev_m_2100 = lev_m+1.09728) %>%
dplyr::select(1,4,3)
#RCP 4.5 , 2100, el nino year, MSL
lev_2100_elnino_RCP4 <- lev_2015_MSL %>%
mutate(lev_m_2100 = lev_m+0.39624) %>%
dplyr::select(1,4,3)
#RCP 8.5 , 2050, normal year, MSL
lev_2050_normal_RCP8 <- lev_2011_MSL %>%
mutate(lev_m_2100 = lev_m+0.2911) %>%
dplyr::select(1,4,3)
#RCP 4.5 , 2050, normal year, MSL
lev_2050_normal_RCP4 <- lev_2011_MSL %>%
mutate(lev_m_2100 = lev_m+0.179) %>%
dplyr::select(1,4,3)
#RCP 8.5 , 2050, el nino year, MSL
lev_2050_elnino__RCP8 <- lev_2015_MSL %>%
mutate(lev_m_2100 = lev_m+0.2911) %>%
dplyr::select(1,4,3)
#RCP 4.5 , 2050, el nino year, MSL
lev_2050_elnino_RCP4 <- lev_2015_MSL %>%
mutate(lev_m_2100 = lev_m+0.179) %>%
dplyr::select(1,4,3)
#Elevation #these elevations from K thorne are all in NAVD88
elv_m_2011<- raster("WARMER/Newport_DEM_m_2011.TIF")
elv_m_2013<- raster("WARMER/Newport_DEM_m_2013.TIF")
elv_m_2014<- raster("WARMER/Newport_DEM_m_2014.TIF")
elv_m_2015<- raster("WARMER/Newport_DEM_m_2015.TIF")
elv_m_2016<- raster("WARMER/Newport_DEM_m_2016.TIF")
elv_m_2017<- raster("WARMER/Newport_DEM_m_2017.TIF")
elv_m_2018<- raster("WARMER/Newport_DEM_m_2018.TIF")
elv_m_2019<- raster("WARMER/Newport_DEM_m_2019.TIF")
#for prediction: baseline elevation from delft for the whole marsh, elevation is in MSL
elv_m_2017_baseline <- raster("C:/Users/JennyT/Documents/LitReview/UCI/working data/Delft3D/elevation_post_Mar_9_2017.TIF")
extent <- extent(c(1847000, 1850050, 661700, 666000))
elv_m_2017_baseline <- crop(elv_m_2017_baseline, extent) #crop to marsh extent
#for prediction: baseline elevation from delft for the whole marsh, elevation is in MSL
elv_m_2015_baseline <- raster("C:/Users/JennyT/Documents/LitReview/UCI/working data/Delft3D/elevation_post_Jan_11_2015.TIF")
extent <- extent(c(1847000, 1850050, 661700, 666000))
elv_m_2015_baseline <- crop(elv_m_2015_baseline, extent) #crop to marsh extent
#for prediction: future elevation with dredging, 0.179m SLR, elevation is in MSL
elv_m_2050_dre_RCP4 <- crop(raster("RCP4_dredging_2050/Bed_Level_2050.TIF"), extent)
#for prediction: future elevation with dredging, 0.2911m  SLR, elevation is in MSL
elv_m_2050_dre_RCP8 <- crop(raster("RCP8_2050_dredging/RCP8_2050_dredging.TIF"), extent)
#for prediction: future elevation withOUT dredging, 0.179m SLR, elevation is in MSL
elv_m_2050_ND_RCP4 <- crop(raster("RCP4_no_dredging_2050/RCP4_no_dredging_2050.TIF"),extent)
#for prediction: future elevation withOUT dredging, 0.2911m  SLR, elevation is in MSL
elv_m_2050_ND_RCP8 <- crop(raster("RCP8_2050_no_dredging/RCP8_2050_no_dredging.TIF"), extent)
#for prediction: future elevation withOUT dredging, 1.09728m  SLR, elevation is in MSL
elv_m_2100_ND_RCP8 <- crop(raster("RCP8_2100_no_dredging/BL_2100.TIF"), extent)
inundation<-function(elv, lev){
inund<-elv #initiate rasterStack using the elevation file
for (i in 1:nrow(lev)) {
temp<-elv-lev[i,2]
inund<-stack(inund,temp)
cat(i, '\t')
}
inund<-dropLayer(inund,1)
}
# functions to calucate water level metrics for summer and winter
avg_height_above_water_level <- function(x){mean(x[x>0])} #function for average exposure height
avg_depth_below_water_level <- function(x){mean(x[x<0])} #function for avg submergence depth
avg_height <- function(x){mean(x)} #function for mean inundation
max_height_above_water_level <- function(x){max(x)} #function for max distance above water level
max_depth_below_water_level <- function(x){min(x)} #function for max depth below water level
pct_inundated <- function(x){ (sum(x<0))/8784 } #function for percent of annaul hours inundated
inundation_metrics <- function(summ, wint, elv, year){
summ_avg_ht_above_m <- calc(summ, fun = avg_height_above_water_level) #caluclute for each pixel in raster stack (hourly timestep)
summ_avg_ht_below_m <- calc(summ, fun = avg_depth_below_water_level)
summ_avg_ht <- calc(summ, fun = avg_height)
summ_max_ht_above_wl <- calc(summ, fun = max_height_above_water_level)
summ_max_depth_below_wl <- calc(summ, fun = max_depth_below_water_level)
summ_inu_pct <- calc(summ, fun = pct_inundated)
wint_avg_ht_above_m <- calc(wint, fun = avg_height_above_water_level) #caluclute for each pixel in raster stack (hourly timestep)
wint_avg_ht_below_m <- calc(wint, fun = avg_depth_below_water_level)
wint_avg_ht <- calc(wint, fun = avg_height)
wint_max_ht_above_wl <- calc(wint, fun = max_height_above_water_level)
wint_max_depth_below_wl <- calc(wint, fun = max_depth_below_water_level)
wint_inu_pct <- calc(wint, fun = pct_inundated)
#stack the raster objects used in the veg model - names need to be exact
inun_metrics <- stack(summ_avg_ht_above_m, summ_avg_ht_below_m, summ_avg_ht, summ_max_ht_above_wl,
summ_max_depth_below_wl,summ_inu_pct,
wint_avg_ht_above_m, wint_avg_ht_below_m, wint_avg_ht, wint_max_ht_above_wl,
wint_max_depth_below_wl, wint_inu_pct, elv)
#add the summer inundation squared raster layer
summ_inu_pct_sq <- raster(inun_metrics, layer = 6)
summ_inu_pct_sq <- summ_inu_pct_sq^2
inun_metrics <- addLayer(inun_metrics, summ_inu_pct_sq)
names(inun_metrics) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht", "summ_max_ht_above_wl",
"summ_max_depth_below_wl", "summ_inu_pct",
"wint_avg_ht_above_m", "wint_avg_ht_below_m","wint_avg_ht", "wint_max_ht_above_wl",
"wint_max_depth_below_wl", "wint_inu_pct",
"elv_m", "summ_inu_pct_sq")
writeRaster(inun_metrics, paste("C:/Users/JennyT/Documents/LitReview/UCI/working data/", year, "inun_metrics", ".grd", sep = "_"), format = "raster")
return(inun_metrics)
}
inundation<-function(elv, lev){
temp <- elv #initate elv file
values(temp) <- 0 #replace all values with 0 for a blank raster
temp2 <- temp
temp3 <- temp
temp4 <- temp
temp5 <- temp
temp6 <- temp
for (i in 1:nrow(lev)) {
ind <- elv-lev[i,2]
temp <- (temp + (ind > 0) * ind) #mean of avg exposure height
temp2 <- (temp2 + (ind < 0) * ind) #mean of avg exposure height
temp3 <- temp3 + ind #mean inundation
temp4 <- stack(ind, temp4)
temp4 <- calc(temp4, fun=max) #max distance above water level
temp5 <- stack(ind, temp5)
temp5 <- calc(temp5, fun=min) #max depth below water level
temp6 <- temp6 + (ind < 0) #percent of annaul hours inundated
cat(i, '\t')
}
avg_ht_above_m <- temp / nrow(lev)
avg_ht_below_m <- temp2 / nrow(lev)
avg_ht <- temp3 / nrow(lev)
max_ht_above_wl <- temp4
max_depth_below_wl <- temp5
inu_pct <- temp6/8784
inu_pct_sq <- inu_pct^2
inundation_metrics <- stack(avg_ht_above_m, avg_ht_below_m, avg_ht, max_ht_above_wl, max_depth_below_wl, inu_pct, inu_pct_sq)
return(inundation_metrics)
}
#NoDredge, RCP8.5, 2100, El Nino , MSL
summ_2100_nodredge_RCP8_elnino <- inundation(elv = elv_m_2100_ND_RCP8, lev = lev_2100_elnino_RCP8[lev_2100_elnino_RCP8$season=="S",])
names(summ_2100_nodredge_RCP8_elnino) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2100_nodredge_RCP8_elnino <- inundation(elv = elv_m_2100_ND_RCP8, lev = lev_2100_elnino_RCP8[lev_2100_elnino_RCP8$season=="W",])
names(wint_2100_nodredge_RCP8_elnino) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2100_nodredge_RCP8_elnino <- stack(summ_2100_nodredge_RCP8_elnino, wint_2100_nodredge_RCP8_elnino, elv_m_2100_ND_RCP8)
names(inun_metrics_2100_nodredge_RCP8_elnino[[15]]) <- "elv_m"
inun_metrics_2100_nodredge_RCP8_elnino <- writeRaster(inun_metrics_2100_nodredge_RCP8_elnino, "_2100_ND_RCP8_elnino_inun_metrics_.grd")
summ_2100_nodredge_RCP8_normal <- inundation(elv = elv_m_2100_ND_RCP8, lev = lev_2100_normal_RCP8[lev_2100_normal_RCP8$season=="S",])
names(summ_2100_nodredge_RCP8_normal) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2100_nodredge_RCP8_normal <- inundation(elv = elv_m_2100_ND_RCP8, lev = lev_2100_normal_RCP8[lev_2100_normal_RCP8$season=="W",])
names(wint_2100_nodredge_RCP8_normal) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2100_nodredge_RCP8_normal <- stack(summ_2100_nodredge_RCP8_normal, wint_2100_nodredge_RCP8_normal, elv_m_2100_ND_RCP8)
names(inun_metrics_2100_nodredge_RCP8_normal[[15]]) <- "elv_m"
writeRaster(inun_metrics_2100_nodredge_RCP8_elnino, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2100_ND_RCP8_elnino_inun_metrics_.grd")
inun_metrics_2100_nodredge_RCP8_elnino <- writeRaster(inun_metrics_2100_nodredge_RCP8_elnino, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2100_ND_RCP8_elnino_inun_metrics_.grd")
inun_metrics_2100_nodredge_RCP8_elnino <- writeRaster(inun_metrics_2100_nodredge_RCP8_elnino, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2100_ND_RCP8_elnino_inun_metrics_.grd")
inun_metrics_2100_nodredge_RCP8_normal <- writeRaster(inun_metrics_2100_nodredge_RCP8_normal, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2100_ND_RCP8_normal_inun_metrics_.grd")
inun_metrics_2100_nodredge_RCP8_elnino <- writeRaster(inun_metrics_2100_nodredge_RCP8_elnino, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2100_ND_RCP8_elnino_inun_metrics_.grd")
inun_metrics_2100_nodredge_RCP8_elnino <- writeRaster(inun_metrics_2100_nodredge_RCP8_elnino, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2100_ND_RCP8_elnino_inun_metrics_.grd")
inun_metrics_2100_nodredge_RCP8_normal <- writeRaster(inun_metrics_2100_nodredge_RCP8_normal, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2100_ND_RCP8_normal_inun_metrics_.grd")
inun_metrics_2100_nodredge_RCP8_elnino <- stack(summ_2100_nodredge_RCP8_elnino, wint_2100_nodredge_RCP8_elnino, elv_m_2100_ND_RCP8)
names(inun_metrics_2100_nodredge_RCP8_elnino[[15]]) <- "elv_m"
inun_metrics_2100_nodredge_RCP8_elnino <- writeRaster(inun_metrics_2100_nodredge_RCP8_elnino, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2100_ND_RCP8_elnino_inun_metrics_.grd")
summ_2050_dredge_RCP8_elnino <- inundation(elv = elv_m_2050_dre_RCP8, lev = lev_2100_elnino_RCP8[lev_2100_elnino_RCP8$season=="S",])
names(summ_2050_dredge_RCP8_elnino) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_dredge_RCP8_elnino <- inundation(elv = elv_m_2050_dre_RCP8, lev = lev_2100_elnino_RCP8[lev_2100_elnino_RCP8$season=="W",])
names(wint_2050_dredge_RCP8_elnino) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_dredge_RCP8_elnino <- stack(summ_2050_dredge_RCP8_elnino, wint_2050_dredge_RCP8_elnino, elv_m_2050_dre_RCP8)
names(inun_metrics_2050_dredge_RCP8_elnino[[15]]) <- "elv_m"
inun_metrics_2050_dredge_RCP8_elnino <- writeRaster(inun_metrics_2050_dredge_RCP8_elnino, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2050_dredge_RCP8_elnino_inun_metrics_.grd")
#Dredge, RCP8.5, 2050, Normal, MSL
summ_2050_dredge_RCP8_normal <- inundation(elv = elv_m_2050_dre_RCP8, lev = lev_2100_normal_RCP8[lev_2100_normal_RCP8$season=="S",])
names(summ_2050_dredge_RCP8_normal) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_dredge_RCP8_normal <- inundation(elv = elv_m_2050_dre_RCP8, lev = lev_2100_normal_RCP8[lev_2100_normal_RCP8$season=="W",])
names(wint_2050_dredge_RCP8_normal) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_dredge_RCP8_normal <- stack(summ_2050_dredge_RCP8_normal, wint_2050_dredge_RCP8_normal, elv_m_2050_dre_RCP8)
names(inun_metrics_2050_dredge_RCP8_normal[[15]]) <- "elv_m"
inun_metrics_2050_dredge_RCP8_normal <- writeRaster(inun_metrics_2050_dredge_RCP8_normal, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2050_dredge_RCP8_normal_inun_metrics_.grd")
#Dredge, RCP4.5, 2050, El Nino , MSL
summ_2050_dredge_RCP4_elnino <- inundation(elv = elv_m_2050_dre_RCP4 , lev = lev_2100_elnino_RCP4[lev_2100_elnino_RCP4$season=="S",])
names(summ_2050_dredge_RCP4_elnino) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_dredge_RCP4_elnino <- inundation(elv = elv_m_2050_dre_RCP4 , lev = lev_2100_elnino_RCP4[lev_2100_elnino_RCP4$season=="W",])
names(wint_2050_dredge_RCP4_elnino) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_dredge_RCP4_elnino <- stack(summ_2050_dredge_RCP4_elnino, wint_2050_dredge_RCP4_elnino, elv_m_2050_dre_RCP4 )
names(inun_metrics_2050_dredge_RCP4_elnino[[15]]) <- "elv_m"
inun_metrics_2050_dredge_RCP4_elnino <- writeRaster(inun_metrics_2050_dredge_RCP4_elnino, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2050_dredge_RCP4_elnino_inun_metrics_.grd")
#Dredge, RCP4.5, 2050, Normal , MSL
summ_2050_dredge_RCP4_normal <- inundation(elv = elv_m_2050_dre_RCP4 , lev = lev_2100_normal_RCP4[lev_2100_normal_RCP4$season=="S",])
names(summ_2050_dredge_RCP4_normal) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_dredge_RCP4_normal <- inundation(elv = elv_m_2050_dre_RCP4 , lev = lev_2100_normal_RCP4[lev_2100_normal_RCP4$season=="W",])
names(wint_2050_dredge_RCP4_normal) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_dredge_RCP4_normal <- stack(summ_2050_dredge_RCP4_normal, wint_2050_dredge_RCP4_normal, elv_m_2050_dre_RCP4 )
names(inun_metrics_2050_dredge_RCP4_normal[[15]]) <- "elv_m"
inun_metrics_2050_dredge_RCP4_normal <- writeRaster(inun_metrics_2050_dredge_RCP4_normal, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2050_dredge_RCP4_normal_inun_metrics_.grd")
#NoDredge, RCP8.5, 2050, El Nino , MSL
summ_2050_nodredge_RCP8_elnino <- inundation(elv = elv_m_2050_ND_RCP8, lev = lev_2100_elnino_RCP8[lev_2100_elnino_RCP8$season=="S",])
names(summ_2050_nodredge_RCP8_elnino) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_nodredge_RCP8_elnino <- inundation(elv = elv_m_2050_ND_RCP8, lev = lev_2100_elnino_RCP8[lev_2100_elnino_RCP8$season=="W",])
names(wint_2050_nodredge_RCP8_elnino) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_nodredge_RCP8_elnino <- stack(summ_2050_nodredge_RCP8_elnino, wint_2050_nodredge_RCP8_elnino, elv_m_2050_ND_RCP8)
names(inun_metrics_2050_nodredge_RCP8_elnino[[15]]) <- "elv_m"
inun_metrics_2050_nodredge_RCP8_elnino <- writeRaster(inun_metrics_2050_nodredge_RCP8_elnino, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2050_ND_RCP8_elnino_inun_metrics_.grd")
#NoDredge, RCP8.5, 2050, Normal , MSL
summ_2050_nodredge_RCP8_normal <- inundation(elv = elv_m_2050_ND_RCP8, lev = lev_2100_normal_RCP8[lev_2100_normal_RCP8$season=="S",])
names(summ_2050_nodredge_RCP8_normal) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_nodredge_RCP8_normal <- inundation(elv = elv_m_2050_ND_RCP8, lev = lev_2100_normal_RCP8[lev_2100_normal_RCP8$season=="W",])
names(wint_2050_nodredge_RCP8_normal) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_nodredge_RCP8_normal <- stack(summ_2050_nodredge_RCP8_normal, wint_2050_nodredge_RCP8_normal, elv_m_2050_ND_RCP8)
names(inun_metrics_2050_nodredge_RCP8_normal[[15]]) <- "elv_m"
inun_metrics_2050_nodredge_RCP8_normal <- writeRaster(inun_metrics_2050_nodredge_RCP8_normal, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2050_ND_RCP8_normal_inun_metrics_.grd")
#NoDredge, RCP4.5, 2050, El Nino , MSL
summ_2050_nodredge_RCP4_elnino <- inundation(elv = elv_m_2050_ND_RCP4, lev = lev_2100_elnino_RCP4[lev_2100_elnino_RCP4$season=="S",])
names(summ_2050_nodredge_RCP4_elnino) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_nodredge_RCP4_elnino <- inundation(elv = elv_m_2050_ND_RCP4, lev = lev_2100_elnino_RCP4[lev_2100_elnino_RCP4$season=="W",])
names(wint_2050_nodredge_RCP4_elnino) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_nodredge_RCP4_elnino <- stack(summ_2050_nodredge_RCP4_elnino, wint_2050_nodredge_RCP4_elnino, elv_m_2050_ND_RCP4)
names(inun_metrics_2050_nodredge_RCP4_elnino[[15]]) <- "elv_m"
inun_metrics_2050_nodredge_RCP4_elnino <- writeRaster(inun_metrics_2050_nodredge_RCP4_elnino, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2050_ND_RCP4_elnino_inun_metrics_.grd")
#NoDredge, RCP4.5, 2050, Normal  , MSL
summ_2050_nodredge_RCP4_normal <- inundation(elv = elv_m_2050_ND_RCP4, lev = lev_2100_normal_RCP4[lev_2100_normal_RCP4$season=="S",])
names(summ_2050_nodredge_RCP4_normal) <- c("summ_avg_ht_above_m", "summ_avg_ht_below_m", "summ_avg_ht",
"summ_max_ht_above_wl", "summ_max_depth_below_wl", "summ_inu_pct", "summ_inu_pct_sq")
wint_2050_nodredge_RCP4_normal <- inundation(elv = elv_m_2050_ND_RCP4, lev = lev_2100_normal_RCP4[lev_2100_normal_RCP4$season=="W",])
names(wint_2050_nodredge_RCP4_normal) <- c("wint_avg_ht_above_m", "wint_avg_ht_below_m", "wint_avg_ht",
"wint_max_ht_above_wl", "wint_max_depth_below_wl", "wint_inu_pct", "wint_inu_pct_sq")
inun_metrics_2050_nodredge_RCP4_normal <- stack(summ_2050_nodredge_RCP4_normal, wint_2050_nodredge_RCP4_normal, elv_m_2050_ND_RCP4)
names(inun_metrics_2050_nodredge_RCP4_normal[[15]]) <- "elv_m"
inun_metrics_2050_nodredge_RCP4_normal <- writeRaster(inun_metrics_2050_nodredge_RCP4_normal, "C:/Users/JennyT/Documents/LitReview/UCI/working data/_2050_ND_RCP4_normal_inun_metrics_.grd")
